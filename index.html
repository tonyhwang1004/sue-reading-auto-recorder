<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÜ 100Îßå Ïú†ÌäúÎ≤Ñ ÏûêÎèô ÏÉùÏÑ±Í∏∞ Ultimate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --warning: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
            --danger: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            --dark: #1a1a1a;
            --light: #ffffff;
            --shadow: 0 20px 60px rgba(0,0,0,0.3);
            --glow: 0 0 40px rgba(102, 126, 234, 0.6);
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 30%, #f093fb 70%, #00f2fe 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            color: white;
            overflow-x: hidden;
            line-height: 1.6;
            min-height: 100vh;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 0%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        /* Î©îÏù∏ Ìó§Îçî */
        .hero {
            text-align: center;
            padding: 100px 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 30px;
            margin-bottom: 40px;
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(transparent, rgba(255,255,255,0.1), transparent);
            animation: heroRotate 25s linear infinite;
            z-index: -1;
        }

        @keyframes heroRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .hero h1 {
            font-size: clamp(3em, 8vw, 5em);
            font-weight: 900;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff6b6b);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: textShimmer 5s ease infinite;
            filter: drop-shadow(0 0 30px rgba(255,255,255,0.3));
        }

        @keyframes textShimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .hero-subtitle {
            font-size: 1.8em;
            opacity: 0.95;
            margin-bottom: 40px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.7);
        }

        .hero-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 50px;
        }

        .feature-card {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.4s ease;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-color: #4ecdc4;
        }

        .feature-icon {
            font-size: 3.5em;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(0 0 15px currentColor);
        }

        /* ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        .section {
            background: rgba(255,255,255,0.1);
            border-radius: 25px;
            padding: 50px;
            margin: 40px 0;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.8s ease;
        }

        .section:hover::before {
            left: 100%;
        }

        .section.connected {
            background: rgba(0,255,100,0.15);
            border-color: rgba(0,255,100,0.5);
            box-shadow: var(--glow);
        }

        .section h2 {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            color: #4ecdc4;
            text-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
            font-weight: 900;
        }

        /* ÏûÖÎ†• ÌïÑÎìú */
        .input-group {
            margin: 30px 0;
        }

        .input-label {
            display: block;
            font-weight: 700;
            margin-bottom: 15px;
            color: #4ecdc4;
            font-size: 1.4em;
            text-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }

        .input-field {
            width: 100%;
            padding: 22px 30px;
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            color: white;
            font-size: 1.3em;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            font-family: inherit;
        }

        .input-field:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.4);
            transform: scale(1.02);
            background: rgba(255,255,255,0.15);
        }

        .input-field::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .textarea-field {
            min-height: 200px;
            resize: vertical;
            line-height: 1.6;
        }

        /* Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        .btn {
            padding: 18px 35px;
            border: none;
            border-radius: 20px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
            margin: 12px;
            font-family: inherit;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transition: all 0.6s ease;
            transform: translate(-50%, -50%);
        }

        .btn:hover:not(:disabled)::before {
            width: 400px;
            height: 400px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-generate {
            background: var(--secondary);
            color: white;
            font-size: 1.8em;
            padding: 30px 60px;
            border-radius: 30px;
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 60px auto;
            position: relative;
            z-index: 1;
            border: none;
            cursor: pointer;
            font-family: inherit;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.4s ease;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* Î™®Îìú ÏÑ†ÌÉù */
        .mode-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .mode-card {
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }

        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s ease;
        }

        .mode-card:hover::before {
            left: 100%;
        }

        .mode-card.selected {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            box-shadow: 0 0 40px rgba(78, 205, 196, 0.4);
            transform: translateY(-5px);
        }

        .mode-card:hover {
            transform: translateY(-8px);
            border-color: #4ecdc4;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .mode-icon {
            font-size: 4em;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(0 0 20px currentColor);
        }

        /* API ÏÑ§Ï†ï */
        .api-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .api-card {
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
        }

        .api-card.connected {
            border-color: #43e97b;
            background: rgba(67, 233, 123, 0.1);
            box-shadow: 0 0 30px rgba(67, 233, 123, 0.3);
        }

        /* ÏßÑÌñâ ÏÉÅÌô© Î™®Îã¨ */
        .progress-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 5000;
            backdrop-filter: blur(20px);
        }

        .progress-modal.show {
            display: flex;
        }

        .progress-content {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 35px;
            padding: 80px;
            text-align: center;
            backdrop-filter: blur(30px);
            max-width: 600px;
            width: 90%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 30px 80px rgba(0,0,0,0.5);
        }

        .progress-icon {
            font-size: 6em;
            margin-bottom: 30px;
            animation: progressRotate 3s ease-in-out infinite;
            filter: drop-shadow(0 0 40px currentColor);
        }

        @keyframes progressRotate {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            overflow: hidden;
            margin: 30px 0;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 12px;
            box-shadow: 0 0 25px rgba(79, 172, 254, 0.5);
        }

        /* Í≤∞Í≥º ÏÑπÏÖò */
        .result-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 15px 30px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 1.1em;
        }

        .tab-btn.active {
            background: rgba(78,205,196,0.3);
            border-color: #4ecdc4;
            color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78,205,196,0.3);
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: #4ecdc4;
        }

        .tab-content {
            display: none;
            margin: 30px 0;
        }

        .tab-content.active {
            display: block;
        }

        /* Ïä¨ÎùºÏù¥ÎìúÏáº */
        .slideshow-container {
            position: relative;
            max-width: 600px;
            margin: 40px auto;
            background: #000;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 4px solid rgba(255,255,255,0.3);
            aspect-ratio: 9/16;
        }

        .slide {
            display: none;
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px 30px;
            animation: slideIn 1s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .slide-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(0,0,0,0.7) 0%,
                rgba(0,0,0,0.3) 50%,
                rgba(0,0,0,0.7) 100%
            );
            z-index: 1;
        }

        .slide-content {
            position: relative;
            z-index: 3;
            text-align: center;
            max-width: 100%;
        }

        .slide-icon {
            font-size: 4.5em;
            margin-bottom: 25px;
            animation: iconFloat 3s ease-in-out infinite;
            filter: drop-shadow(0 0 20px currentColor);
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }

        .slide-title {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 20px;
            text-shadow: 3px 3px 10px rgba(0,0,0,0.8);
            line-height: 1.1;
            background: linear-gradient(45deg, #fff, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            word-wrap: break-word;
        }

        .slide-subtitle {
            font-size: 1.4em;
            opacity: 0.95;
            margin-bottom: 25px;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.8);
            line-height: 1.4;
            word-wrap: break-word;
        }

        /* ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò */
        .slide-navigation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255,255,255,0.15);
            border: 3px solid rgba(255,255,255,0.4);
            color: white;
            padding: 18px 30px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            font-weight: 700;
            font-size: 1.2em;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }

        .slide-counter {
            background: rgba(0,0,0,0.7);
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 700;
            color: #4ecdc4;
            font-size: 1.3em;
            border: 3px solid rgba(78, 205, 196, 0.3);
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
        }

        /* Ïù¥ÎØ∏ÏßÄ Í∞§Îü¨Î¶¨ */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .gallery-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.3);
            aspect-ratio: 1;
        }

        .gallery-item:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #4ecdc4;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.05);
        }

        .gallery-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 0.9em;
            font-weight: bold;
        }

        /* ÏÉÅÌÉú Î©îÏãúÏßÄ */
        .status-message {
            margin: 25px 0;
            padding: 20px 35px;
            border-radius: 20px;
            font-weight: 700;
            text-align: center;
            display: none;
            backdrop-filter: blur(15px);
            font-size: 1.2em;
            border: 2px solid;
        }

        .status-message.success {
            background: rgba(0,255,100,0.2);
            border-color: rgba(0,255,100,0.5);
            color: #00ff88;
            box-shadow: 0 0 30px rgba(0,255,100,0.3);
        }

        .status-message.error {
            background: rgba(255,0,100,0.2);
            border-color: rgba(255,0,100,0.5);
            color: #ff6b6b;
            box-shadow: 0 0 30px rgba(255,0,100,0.3);
        }

        .status-message.warning {
            background: rgba(255,165,0,0.2);
            border-color: rgba(255,165,0,0.5);
            color: #ffa500;
            box-shadow: 0 0 30px rgba(255,165,0,0.3);
        }

        /* ÎÖπÌôî UI */
        .recording-ui {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0,0,0,0.95) 0%, rgba(30,30,60,0.98) 100%);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(20px);
        }

        .recording-ui.show {
            display: flex;
        }

        .recording-content {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border: 4px solid rgba(255,68,68,0.6);
            border-radius: 35px;
            padding: 60px;
            text-align: center;
            backdrop-filter: blur(30px);
            max-width: 700px;
            box-shadow: 0 0 60px rgba(255,68,68,0.3);
            position: relative;
            overflow: hidden;
        }

        .recording-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(transparent, rgba(255,68,68,0.1), transparent);
            animation: recordingRotate 10s linear infinite;
            z-index: -1;
        }

        @keyframes recordingRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ÏÑ±Í≥µ ÏïåÎ¶º */
        .success-notification {
            position: fixed;
            top: 30px;
            right: 30px;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            padding: 25px 35px;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 15px 40px rgba(67, 233, 123, 0.4);
            transform: translateX(500px);
            transition: transform 0.6s ease;
            z-index: 8000;
            font-size: 1.1em;
        }

        .success-notification.show {
            transform: translateX(0);
        }

        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .hero {
                padding: 60px 20px;
            }
            
            .section {
                padding: 30px 20px;
            }
            
            .hero h1 {
                font-size: 2.5em;
            }
            
            .hero-subtitle {
                font-size: 1.4em;
            }
            
            .slide-title {
                font-size: 2em;
            }
            
            .slide-subtitle {
                font-size: 1.2em;
            }
            
            .mode-selector {
                grid-template-columns: 1fr;
            }
            
            .api-grid {
                grid-template-columns: 1fr;
            }
            
            .image-gallery {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .slide-navigation {
                gap: 20px;
            }
            
            .nav-btn {
                padding: 15px 25px;
                font-size: 1em;
            }
            
            .btn-generate {
                font-size: 1.4em;
                padding: 25px 40px;
            }
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò ÌÇ§ÌîÑÎ†àÏûÑ */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(78, 205, 196, 0.3); }
            50% { box-shadow: 0 0 40px rgba(78, 205, 196, 0.8); }
        }

        /* ÌäπÏàò Ìö®Í≥º */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            animation: particleFloat 8s ease-in-out infinite;
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0) translateX(0) scale(1);
                opacity: 0.6;
            }
            50% {
                transform: translateY(-30px) translateX(15px) scale(1.3);
                opacity: 1;
            }
        }

        /* Ï∂îÍ∞Ä Ïú†Ìã∏Î¶¨Ìã∞ ÌÅ¥ÎûòÏä§ */
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .mb-20 { margin-bottom: 20px; }
        .mb-30 { margin-bottom: 30px; }
        .mt-20 { margin-top: 20px; }
        .mt-30 { margin-top: 30px; }
        .p-20 { padding: 20px; }
        .p-30 { padding: 30px; }
        
        .hidden { display: none !important; }
        .visible { display: block !important; }
        
        .loading {
            animation: spin 1s linear infinite;
        }
        
        .pulsing {
            animation: pulse 2s ease-in-out infinite;
        }
        
        .glowing {
            animation: glow 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Îñ†Îã§ÎãàÎäî ÌååÌã∞ÌÅ¥ ÏãúÏä§ÌÖú -->
    <div class="floating-particles" id="floatingParticles"></div>

    <div class="container">
        <!-- Î©îÏù∏ Ìó§Îçî -->
        <div class="hero">
            <h1>üèÜ 100Îßå Ïú†ÌäúÎ≤Ñ ÏûêÎèô ÏÉùÏÑ±Í∏∞</h1>
            <p class="hero-subtitle">GPT-4 + DALL-E 3Î°ú ÏΩòÌÖêÏ∏†Î∂ÄÌÑ∞ Ïù¥ÎØ∏ÏßÄ, ÏòÅÏÉÅÍπåÏßÄ ÏôÑÏ†Ñ ÏûêÎèôÌôî!</p>
            
            <div class="hero-features">
                <div class="feature-card">
                    <span class="feature-icon">ü§ñ</span>
                    <h3>GPT-4 Ïã§Ï†ú Î∂ÑÏÑù</h3>
                    <p>ÌÇ§ÏõåÎìúÎßå ÏûÖÎ†•ÌïòÎ©¥ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† ÏûêÎèô ÏÉùÏÑ±</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üé®</span>
                    <h3>DALL-E 3 Ïù¥ÎØ∏ÏßÄ</h3>
                    <p>AIÍ∞Ä ÎßåÎì† ÏôÑÎ≤ΩÌïú Ïç∏ÎÑ§ÏùºÍ≥º Ïä¨ÎùºÏù¥Îìú Ïù¥ÎØ∏ÏßÄ</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üé¨</span>
                    <h3>ÏûêÎèô ÏòÅÏÉÅ ÏÉùÏÑ±</h3>
                    <p>Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏôÑÎ≤Ω ÏµúÏ†ÅÌôî 45Ï¥à ÏòÅÏÉÅ</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üöÄ</span>
                    <h3>100ÎßåÎ∑∞ ÏµúÏ†ÅÌôî</h3>
                    <p>Î∞îÏù¥Îü¥ Í≥µÏãù Ï†ÅÏö©Îêú ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏†</p>
                </div>
            </div>
        </div>

        <!-- API ÏÑ§Ï†ï ÏÑπÏÖò -->
        <div class="section">
            <h2>üîë AI ÏóîÏßÑ ÏÑ§Ï†ï</h2>
            <p style="text-align: center; margin-bottom: 30px; font-size: 1.2em;">
                GPT-4ÏôÄ DALL-E 3ÏùÑ Ïó∞Í≤∞ÌïòÏó¨ ÏôÑÏ†Ñ ÏûêÎèôÌôîÎêú ÏΩòÌÖêÏ∏† ÏÉùÏÑ±ÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî
            </p>
            
            <div class="api-grid">
                <!-- OpenAI API ÏÑ§Ï†ï -->
                <div class="api-card" id="openaiCard">
                    <h3 style="color: #4ecdc4; margin-bottom: 20px; font-size: 1.8em;">üß† OpenAI API</h3>
                    
                    <div class="input-group">
                        <label class="input-label">üîë API ÌÇ§</label>
                        <input type="password" class="input-field" id="openaiKey" 
                               placeholder="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ü§ñ GPT Î™®Îç∏</label>
                        <div class="mode-selector" style="margin: 15px 0;">
                            <div class="mode-card selected" id="gpt4oCard" onclick="selectGPTModel('gpt-4o')">
                                <span class="mode-icon">üß†</span>
                                <h4>GPT-4o</h4>
                                <p>ÏµúÍ≥† ÏÑ±Îä•, ÏôÑÎ≤ΩÌïú Î∂ÑÏÑù</p>
                            </div>
                            <div class="mode-card" id="gpt4Card" onclick="selectGPTModel('gpt-4')">
                                <span class="mode-icon">‚ö°</span>
                                <h4>GPT-4</h4>
                                <p>ÏïàÏ†ïÏ†ÅÏù¥Í≥† Ï†ïÌôïÌïú Î∂ÑÏÑù</p>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" id="connectOpenAIBtn">üîó OpenAI Ïó∞Í≤∞</button>
                    <div class="status-message" id="openaiStatus"></div>
                </div>

                <!-- DALL-E 3 ÏÑ§Ï†ï -->
                <div class="api-card" id="dalleCard">
                    <h3 style="color: #4ecdc4; margin-bottom: 20px; font-size: 1.8em;">üé® DALL-E 3</h3>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                        <h4 style="color: #feca57; margin-bottom: 15px;">üéØ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏÑ§Ï†ï</h4>
                        
                        <div class="input-group">
                            <label class="input-label">üñºÔ∏è Ïù¥ÎØ∏ÏßÄ ÌíàÏßà</label>
                            <select class="input-field" id="imageQuality">
                                <option value="hd">HD (Í≥†ÌíàÏßà) - Ï∂îÏ≤ú</option>
                                <option value="standard">ÌëúÏ§Ä (Îπ†Î•∏ ÏÉùÏÑ±)</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">üìê Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞</label>
                            <select class="input-field" id="imageSize">
                                <option value="1024x1792">ÏÑ∏Î°úÌòï (1024x1792) - ÏáºÏ∏† ÏµúÏ†ÅÌôî</option>
                                <option value="1792x1024">Í∞ÄÎ°úÌòï (1792x1024)</option>
                                <option value="1024x1024">Ï†ïÏÇ¨Í∞ÅÌòï (1024x1024)</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">üé® Ïù¥ÎØ∏ÏßÄ Ïä§ÌÉÄÏùº</label>
                            <select class="input-field" id="imageStyle">
                                <option value="vivid">ÏÉùÏÉùÌï® (Vivid) - Î∞îÏù¥Îü¥ ÏµúÏ†ÅÌôî</option>
                                <option value="natural">ÏûêÏó∞Ïä§Îü¨ÏõÄ (Natural)</option>
                            </select>
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary" id="testDALLEBtn">üé® DALL-E 3 ÌÖåÏä§Ìä∏</button>
                    <div class="status-message" id="dalleStatus"></div>
                </div>
            </div>
            
            <!-- Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ -->
            <div style="background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 20px; padding: 30px; margin: 30px 0; text-align: center;">
                <h3 style="color: #4ecdc4; margin-bottom: 20px;">üîó AI Ïó∞Í≤∞ ÏÉÅÌÉú</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div id="gptStatus" style="padding: 15px; border-radius: 15px; background: rgba(255,68,68,0.2); border: 2px solid rgba(255,68,68,0.5);">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚ùå</div>
                        <div>GPT-4 Ïó∞Í≤∞ ÎåÄÍ∏∞Ï§ë</div>
                    </div>
                    <div id="dalleConnectionStatus" style="padding: 15px; border-radius: 15px; background: rgba(255,68,68,0.2); border: 2px solid rgba(255,68,68,0.5);">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚ùå</div>
                        <div>DALL-E 3 Ïó∞Í≤∞ ÎåÄÍ∏∞Ï§ë</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏΩòÌÖêÏ∏† ÏÉùÏÑ± ÏÑπÏÖò -->
        <div class="section">
            <h2>üöÄ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† ÏûêÎèô ÏÉùÏÑ±</h2>
            <p style="text-align: center; margin-bottom: 30px; font-size: 1.2em;">
                ÌÇ§ÏõåÎìúÎÇò Ï£ºÏ†úÎßå ÏûÖÎ†•ÌïòÎ©¥ 100ÎßåÎ∑∞ ÏΩòÌÖêÏ∏†Í∞Ä ÏûêÎèôÏúºÎ°ú ÎßåÎì§Ïñ¥ÏßëÎãàÎã§
            </p>
            
            <!-- ÏÉùÏÑ± Î™®Îìú ÏÑ†ÌÉù -->
            <div class="input-group">
                <label class="input-label">üéØ ÏÉùÏÑ± Î™®Îìú</label>
                <div class="mode-selector">
                    <div class="mode-card selected" id="autoMode" onclick="selectGenerationMode('auto')">
                        <span class="mode-icon">ü§ñ</span>
                        <h3>ÏôÑÏ†Ñ ÏûêÎèô Î™®Îìú</h3>
                        <p>ÌÇ§ÏõåÎìúÎßå ÏûÖÎ†•ÌïòÎ©¥ ÏΩòÌÖêÏ∏†Î∂ÄÌÑ∞ Ïù¥ÎØ∏ÏßÄÍπåÏßÄ ÏûêÎèô ÏÉùÏÑ±</p>
                        <div style="color: #43e97b; font-weight: bold; margin-top: 10px;">‚úÖ Ï∂îÏ≤ú (100ÎßåÎ∑∞ ÏµúÏ†ÅÌôî)</div>
                    </div>
                    <div class="mode-card" id="semiAutoMode" onclick="selectGenerationMode('semi-auto')">
                        <span class="mode-icon">‚úèÔ∏è</span>
                        <h3>Î∞òÏûêÎèô Î™®Îìú</h3>
                        <p>Ï†úÎ™©Í≥º ÎÇ¥Ïö©ÏùÑ ÏßÅÏ†ë ÏûÖÎ†•ÌïòÍ≥† Ïù¥ÎØ∏ÏßÄÎäî ÏûêÎèô ÏÉùÏÑ±</p>
                        <div style="color: #feca57; font-weight: bold; margin-top: 10px;">‚ö° Îπ†Î•∏ Ï†úÏûë</div>
                    </div>
                    <div class="mode-card" id="manualMode" onclick="selectGenerationMode('manual')">
                        <span class="mode-icon">üìù</span>
                        <h3>ÏàòÎèô Î™®Îìú</h3>
                        <p>Î™®Îì† ÎÇ¥Ïö©ÏùÑ ÏßÅÏ†ë ÏûÖÎ†• (Í∏∞Ï°¥ Î∞©Ïãù)</p>
                        <div style="color: #95a5a6; font-weight: bold; margin-top: 10px;">üõ†Ô∏è Ïª§Ïä§ÌÖÄ</div>
                    </div>
                </div>
            </div>

            <!-- ÏôÑÏ†Ñ ÏûêÎèô Î™®Îìú ÏûÖÎ†• -->
            <div id="autoModeInputs" class="mode-inputs">
                <div class="input-group">
                    <label class="input-label">üî• Î∞îÏù¥Îü¥ ÌÇ§ÏõåÎìú ÎòêÎäî Ï£ºÏ†ú</label>
                    <input type="text" class="input-field" id="viralKeyword" 
                           placeholder="Ïòà: AI, Ìà¨Ïûê, Îã§Ïù¥Ïñ¥Ìä∏, Ïó∞Ïï†, Î∂ÄÏóÖ, ÏÑ±Í≥µÎπÑÎ≤ï Îì±">
                </div>
                
                <div class="input-group">
                    <label class="input-label">üéØ ÌÉÄÍ≤ü Ï±ÑÎÑê Ïú†Ìòï</label>
                    <select class="input-field" id="channelType">
                        <option value="educational">ÍµêÏú°/Ï†ïÎ≥¥ (How-to, ÌåÅ)</option>
                        <option value="entertainment">ÏóîÌÑ∞ÌÖåÏù∏Î®ºÌä∏ (Ïû¨ÎØ∏, Ïú†Î®∏)</option>
                        <option value="lifestyle">ÎùºÏù¥ÌîÑÏä§ÌÉÄÏùº (ÏùºÏÉÅ, Ï∑®ÎØ∏)</option>
                        <option value="business">ÎπÑÏ¶àÎãàÏä§ (Ï∞ΩÏóÖ, Ìà¨Ïûê)</option>
                        <option value="motivation">ÎèôÍ∏∞Î∂ÄÏó¨ (ÏÑ±Í≥µ, ÏûêÍ∏∞Í≥ÑÎ∞ú)</option>
                        <option value="trending">Ìä∏Î†åÎìú (ÏµúÏã† Ïù¥Ïäà)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label class="input-label">üé® ÏΩòÌÖêÏ∏† ÌÜ§Ïï§Îß§ÎÑà</label>
                    <select class="input-field" id="contentTone">
                        <option value="casual">ÏπúÍ∑ºÌïòÍ≥† Ï∫êÏ£ºÏñº</option>
                        <option value="professional">Ï†ÑÎ¨∏Ï†ÅÏù¥Í≥† Ïã†Î¢∞Í∞ê ÏûàÎäî</option>
                        <option value="energetic">ÏóêÎÑàÏßÄ ÎÑòÏπòÍ≥† Ïó¥Ï†ïÏ†ÅÏù∏</option>
                        <option value="mysterious">Ïã†ÎπÑÎ°≠Í≥† Ìò∏Í∏∞Ïã¨ Ïú†Î∞ú</option>
                        <option value="humorous">Ïú†Î®∏Îü¨Ïä§ÌïòÍ≥† Ïû¨ÎØ∏ÏûàÎäî</option>
                    </select>
                </div>
            </div>

            <!-- Î∞òÏûêÎèô Î™®Îìú ÏûÖÎ†• -->
            <div id="semiAutoModeInputs" class="mode-inputs hidden">
                <div class="input-group">
                    <label class="input-label">üìù ÏΩòÌÖêÏ∏† Ï†úÎ™©</label>
                    <input type="text" class="input-field" id="contentTitle" 
                           placeholder="Îß§Î†•Ï†ÅÏù∏ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>
                
                <div class="input-group">
                    <label class="input-label">üìÑ ÏΩòÌÖêÏ∏† ÎÇ¥Ïö©</label>
                    <textarea class="input-field textarea-field" id="contentDescription" 
                              placeholder="Ï†ÑÎã¨ÌïòÍ≥† Ïã∂ÏùÄ Î©îÏãúÏßÄÎÇò Ï†ïÎ≥¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
                </div>
            </div>

            <!-- ÏàòÎèô Î™®Îìú ÏûÖÎ†• -->
            <div id="manualModeInputs" class="mode-inputs hidden">
                <div class="input-group">
                    <label class="input-label">üìù Ï†úÎ™©</label>
                    <input type="text" class="input-field" id="manualTitle" 
                           placeholder="Ïä¨ÎùºÏù¥Îìú Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>

                <div class="input-group">
                    <label class="input-label">üìÑ ÎÇ¥Ïö©</label>
                    <textarea class="input-field textarea-field" id="manualContent" 
                              placeholder="Ïä¨ÎùºÏù¥ÎìúÏóê Ìè¨Ìï®Ìï† ÎÇ¥Ïö©ÏùÑ ÏÉÅÏÑ∏Ìûà ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
                </div>
            </div>

            <!-- Í≥†Í∏â ÏÑ§Ï†ï -->
            <div style="background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 20px; padding: 30px; margin: 30px 0;">
                <h3 style="color: #4ecdc4; margin-bottom: 20px;">‚öôÔ∏è Í≥†Í∏â ÏÑ§Ï†ï</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div class="input-group">
                        <label class="input-label">üìä Ïä¨ÎùºÏù¥Îìú Í∞úÏàò</label>
                        <select class="input-field" id="slideCount">
                            <option value="10">10Ïû• (ÏßßÍ≥† ÏûÑÌå©Ìä∏)</option>
                            <option value="15" selected>15Ïû• (ÏµúÏ†Å Í∏∏Ïù¥)</option>
                            <option value="20">20Ïû• (ÏÉÅÏÑ∏Ìïú ÏÑ§Î™Ö)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">üé® ÎπÑÏ£ºÏñº Ïä§ÌÉÄÏùº</label>
                        <select class="input-field" id="visualStyle">
                            <option value="modern">Î™®ÎçòÌïòÍ≥† ÏÑ∏Î†®Îêú</option>
                            <option value="minimalist">ÎØ∏ÎãàÎ©ÄÌïòÍ≥† ÍπîÎÅîÌïú</option>
                            <option value="colorful">Îã§Ï±ÑÎ°≠Í≥† ÌôúÍ∏∞Ï∞¨</option>
                            <option value="elegant">Ïö∞ÏïÑÌïòÍ≥† Í≥†Í∏âÏä§Îü¨Ïö¥</option>
                            <option value="trendy">Ìä∏Î†åÎîîÌïòÍ≥† Ï†äÏùÄ</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">üé¨ Ïï†ÎãàÎ©îÏù¥ÏÖò</label>
                        <select class="input-field" id="animationStyle">
                            <option value="smooth">Î∂ÄÎìúÎü¨Ïö¥ Ï†ÑÌôò</option>
                            <option value="dynamic">Ïó≠ÎèôÏ†ÅÏù∏ ÏõÄÏßÅÏûÑ</option>
                            <option value="minimal">ÏµúÏÜåÌïúÏùò ÏõÄÏßÅÏûÑ</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">üéµ Î∞∞Í≤ΩÏùåÏïÖ</label>
                        <select class="input-field" id="backgroundMusic">
                            <option value="upbeat">ÏóÖÎπÑÌä∏ (ÏóêÎÑàÏßÄ ÎÑòÏπòÎäî)</option>
                            <option value="ambient">Ïó†ÎπÑÏñ∏Ìä∏ (Ï∞®Î∂ÑÌïú)</option>
                            <option value="corporate">ÎπÑÏ¶àÎãàÏä§ (Ï†ÑÎ¨∏Ï†ÅÏù∏)</option>
                            <option value="none">ÏùåÏïÖ ÏóÜÏùå</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- ÏÉùÏÑ± Î≤ÑÌäº -->
            <button class="btn-generate" id="generateButton" onclick="startAutoGeneration()" disabled>
                üöÄ 100ÎßåÎ∑∞ ÏΩòÌÖêÏ∏† ÏûêÎèô ÏÉùÏÑ±ÌïòÍ∏∞
            </button>
        </div>

        <!-- Í≤∞Í≥º ÏÑπÏÖò -->
        <div id="resultSection" class="section hidden">
            <h2>üéâ ÏôÑÏÑ±Îêú Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏†</h2>
            
            <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
            <div class="result-tabs">
                <button class="tab-btn active" onclick="showTab('preview')">üé¨ ÎØ∏Î¶¨Î≥¥Í∏∞</button>
                <button class="tab-btn" onclick="showTab('images')">üé® AI Ïù¥ÎØ∏ÏßÄ</button>
                <button class="tab-btn" onclick="showTab('content')">üìù ÏΩòÌÖêÏ∏†</button>
                <button class="tab-btn" onclick="showTab('analytics')">üìä Î∂ÑÏÑù</button>
            </div>

            <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ ÌÉ≠ -->
            <div id="previewTab" class="tab-content active">
                <div class="slideshow-container" id="slideshowContainer">
                    <!-- Ïä¨ÎùºÏù¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>

                <div class="slide-navigation">
                    <button class="nav-btn" onclick="prevSlide()">‚¨ÖÔ∏è Ïù¥Ï†Ñ</button>
                    <span class="slide-counter" id="slideCounter">1 / 15</span>
                    <button class="nav-btn" onclick="nextSlide()">Îã§Ïùå ‚û°Ô∏è</button>
                    <button class="nav-btn" onclick="toggleAutoPlay()" id="autoPlayBtn">‚ñ∂Ô∏è ÏûêÎèôÏû¨ÏÉù</button>
                </div>
            </div>

            <!-- AI Ïù¥ÎØ∏ÏßÄ ÌÉ≠ -->
            <div id="imagesTab" class="tab-content">
                <h3 style="text-align: center; margin-bottom: 20px;">üé® DALL-E 3Í∞Ä ÏÉùÏÑ±Ìïú Ïù¥ÎØ∏ÏßÄÎì§</h3>
                <div class="image-gallery" id="imageGallery">
                    <!-- AI ÏÉùÏÑ± Ïù¥ÎØ∏ÏßÄÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>

            <!-- ÏΩòÌÖêÏ∏† ÌÉ≠ -->
            <div id="contentTab" class="tab-content">
                <h3 style="text-align: center; margin-bottom: 20px;">üìù ÏÉùÏÑ±Îêú ÏΩòÌÖêÏ∏†</h3>
                <div id="generatedContent" style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; line-height: 1.8;">
                    <!-- ÏÉùÏÑ±Îêú ÏΩòÌÖêÏ∏†Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>

            <!-- Î∂ÑÏÑù ÌÉ≠ -->
            <div id="analyticsTab" class="tab-content">
                <h3 style="text-align: center; margin-bottom: 20px;">üìä Î∞îÏù¥Îü¥ Î∂ÑÏÑù</h3>
                <div id="contentAnalytics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <!-- Î∂ÑÏÑù Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>

            <!-- Ïï°ÏÖò Î≤ÑÌäºÎì§ -->
            <div style="text-align: center; margin: 40px 0;">
                <button class="btn btn-danger" onclick="startRecording()" style="font-size: 1.5em; padding: 25px 50px; margin: 10px;">
                    üé¨ ÏòÅÏÉÅ ÎÖπÌôîÌïòÍ∏∞
                </button>
                <button class="btn btn-primary" onclick="downloadContent()" style="font-size: 1.3em; padding: 20px 40px; margin: 10px;">
                    üíæ ÏΩòÌÖêÏ∏† Îã§Ïö¥Î°úÎìú
                </button>
                <button class="btn btn-secondary" onclick="shareToYouTube()" style="font-size: 1.3em; padding: 20px 40px; margin: 10px;">
                    üì∫ Ïú†ÌäúÎ∏å ÏóÖÎ°úÎìú
                </button>
                <button class="btn btn-success" onclick="regenerateContent()" style="font-size: 1.3em; padding: 20px 40px; margin: 10px;">
                    üîÑ Îã§Ïãú ÏÉùÏÑ±ÌïòÍ∏∞
                </button>
            </div>
        </div>
    </div>

    <!-- ÏßÑÌñâ ÏÉÅÌô© Î™®Îã¨ -->
    <div class="progress-modal" id="progressModal">
        <div class="progress-content">
            <div class="progress-icon" id="progressIcon">ü§ñ</div>
            <h3 id="progressTitle">AIÍ∞Ä Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏†Î•º Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...</h3>
            <p id="progressDesc">GPT-4Í∞Ä 100ÎßåÎ∑∞ Í≥µÏãùÏùÑ Ï†ÅÏö©Ìï¥ÏÑú ÏµúÏ†ÅÏùò ÏΩòÌÖêÏ∏†Î•º ÏÉùÏÑ±Ï§ëÏûÖÎãàÎã§.</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText" style="font-size: 1.4em; font-weight: bold; color: #4ecdc4; margin-top: 20px;">0%</div>
        </div>
    </div>

    <!-- ÎÖπÌôî UI -->
    <div class="recording-ui" id="recordingUI">
        <div class="recording-content">
            <div style="font-size: 6em; margin-bottom: 30px; animation: pulse 2s infinite;">üé¨</div>
            <h2 style="color: #ff4444; margin-bottom: 25px; font-size: 3em; font-weight: 900;">
                ÏôÑÎ≤ΩÌïú ÏòÅÏÉÅ ÎÖπÌôî Ï§ë
            </h2>
            <p style="color: white; margin-bottom: 30px; font-size: 1.5em; line-height: 1.6;">
                Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏµúÏ†ÅÌôî 45Ï¥à ÏòÅÏÉÅÏùÑ ÎÖπÌôîÌïòÍ≥† ÏûàÏäµÎãàÎã§<br>
                <span style="color: #4ecdc4; font-weight: bold;">100% ÏôÑÏÑ±Ïù¥ Î≥¥Ïû•Îê©ÎãàÎã§!</span>
            </p>
            <div id="recordingProgress" style="background: rgba(255,255,255,0.2); height: 30px; border-radius: 15px; overflow: hidden; margin: 30px 0; border: 2px solid rgba(255,68,68,0.3);">
                <div id="recordingProgressBar" style="background: linear-gradient(45deg, #ff4444, #ff6666); height: 100%; width: 0%; transition: width 0.8s ease; border-radius: 12px;"></div>
            </div>
            <div id="recordingStatus" style="color: #4ecdc4; font-weight: bold; font-size: 1.5em; margin-bottom: 25px;">
                ÏïàÏ†ïÏ†ÅÏù∏ ÎÖπÌôî ÏãúÏûë...
            </div>
            <button onclick="stopRecording()" style="padding: 20px 40px; background: linear-gradient(45deg, #ff4444, #ff6666); color: white; border: none; border-radius: 20px; font-size: 1.4em; cursor: pointer; font-weight: bold;">
                ‚èπÔ∏è ÎÖπÌôî Ï§ëÏßÄ
            </button>
        </div>
    </div>

    <script>
        // ===== Ï†ÑÏó≠ Î≥ÄÏàò ÏãúÏä§ÌÖú =====
        let openaiApiKey = '';
        let selectedGPTModel = 'gpt-4o';
        let selectedGenerationMode = 'auto';
        let generatedSlides = [];
        let generatedImages = [];
        let currentSlide = 0;
        let autoPlayInterval = null;
        let isAutoPlaying = false;
        
        // ÎÖπÌôî ÏãúÏä§ÌÖú
        let mediaRecorder = null;
        let recordedChunks = [];
        let isRecording = false;
        let recordingCanvas = null;
        let recordingCtx = null;
        
        // ÏÉùÏÑ± ÏÑ§Ï†ï
        let generationConfig = {
            slideCount: 15,
            visualStyle: 'modern',
            animationStyle: 'smooth',
            backgroundMusic: 'upbeat',
            imageQuality: 'hd',
            imageSize: '1024x1792',
            imageStyle: 'vivid'
        };
        
        // Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† Î∂ÑÏÑù ÏóîÏßÑ
        const viralPatterns = {
            educational: {
                hooks: ['ÎÜÄÎùºÏö¥ ÏÇ¨Ïã§', 'ÏïÑÎ¨¥ÎèÑ Î™®Î•¥Îäî', 'Ï†ÑÎ¨∏Í∞ÄÍ∞Ä ÏïåÎ†§Ï£ºÎäî', 'Ïã§Ï†úÎ°ú Í≤ÄÏ¶ùÎêú'],
                structures: ['Î¨∏Ï†úÏ†úÍ∏∞', 'Ìï¥Í≤∞Î∞©Î≤ï', 'Îã®Í≥ÑÎ≥ÑÏÑ§Î™Ö', 'Í≤∞Í≥ºÌôïÏù∏', 'ÌñâÎèôÏ¥âÍµ¨'],
                emotions: ['Ìò∏Í∏∞Ïã¨', 'ÎÜÄÎùºÏõÄ', 'ÌïôÏäµÏöïÍµ¨', 'ÏÑ±Ï∑®Í∞ê'],
                keywords: ['ÎπÑÎ≤ï', 'Î∞©Î≤ï', 'ÍøÄÌåÅ', 'ÏôÑÏ†ÑÏ†ïÎ≥µ', 'ÎßàÏä§ÌÑ∞']
            },
            entertainment: {
                hooks: ['Ï∂©Í≤©Ï†ÅÏù∏', 'ÏõÉÍ∏¥', 'Ïû¨ÎØ∏ÏûàÎäî', 'ÎÜÄÎùºÏö¥'],
                structures: ['ÏÉÅÌô©Ï†úÏãú', 'Î∞òÏ†ÑÌè¨Ïù∏Ìä∏', 'ÌÅ¥ÎùºÏù¥Îß•Ïä§', 'Í≤∞Îßê'],
                emotions: ['Ïû¨ÎØ∏', 'ÎÜÄÎùºÏõÄ', 'Í≥µÍ∞ê', 'ÏõÉÏùå'],
                keywords: ['ÎåÄÎ∞ï', 'Î†àÏ†ÑÎìú', 'Ïã§Ìôî', 'ÏßÑÏßú', 'ÎØ∏Ï≥§Îã§']
            },
            motivation: {
                hooks: ['ÏÑ±Í≥µÌïú ÏÇ¨ÎûåÎì§Ïùò', 'Ïù∏ÏÉùÏùÑ Î∞îÍæ∏Îäî', 'ÌõÑÌöåÌïòÏßÄ ÏïäÎäî'],
                structures: ['ÌòÑÏã§Ïù∏Ïãù', 'Î™©ÌëúÏÑ§Ï†ï', 'Ïã§ÌñâÎ∞©Î≤ï', 'ÏÑ±Í≥µÏÇ¨Î°Ä'],
                emotions: ['ÎèôÍ∏∞Î∂ÄÏó¨', 'Ìù¨Îßù', 'Í≤∞Ïã¨', 'ÏÑ±Ï∑®ÏöïÍµ¨'],
                keywords: ['ÏÑ±Í≥µ', 'Î≥ÄÌôî', 'ÏÑ±Ïû•', 'ÎèÑÏ†Ñ', 'Í∑πÎ≥µ']
            }
        };

        // ===== Ï¥àÍ∏∞Ìôî ÏãúÏä§ÌÖú =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ 100Îßå Ïú†ÌäúÎ≤Ñ ÏûêÎèô ÏÉùÏÑ±Í∏∞ Ï¥àÍ∏∞Ìôî ÏãúÏûë');
            
            initializeParticles();
            initializeEventListeners();
            updateGenerateButton();
            loadSavedSettings();
            
            console.log('‚úÖ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        });

        // ===== Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï¥àÍ∏∞Ìôî (ÏàòÏ†ïÎê®) =====
        function initializeEventListeners() {
            console.log('üéØ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï¥àÍ∏∞Ìôî ÏãúÏûë');
            
            // API Ïó∞Í≤∞ Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            const connectBtn = document.getElementById('connectOpenAIBtn');
            if (connectBtn) {
                console.log('‚úÖ OpenAI Ïó∞Í≤∞ Î≤ÑÌäº Ï∞æÏùå');
                connectBtn.addEventListener('click', function() {
                    console.log('üîó OpenAI Ïó∞Í≤∞ Î≤ÑÌäº ÌÅ¥Î¶≠Îê®!');
                    connectOpenAI();
                });
            } else {
                console.error('‚ùå OpenAI Ïó∞Í≤∞ Î≤ÑÌäºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
            }
            
            // DALL-E ÌÖåÏä§Ìä∏ Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            const testBtn = document.getElementById('testDALLEBtn');
            if (testBtn) {
                console.log('‚úÖ DALL-E ÌÖåÏä§Ìä∏ Î≤ÑÌäº Ï∞æÏùå');
                testBtn.addEventListener('click', function() {
                    console.log('üé® DALL-E ÌÖåÏä§Ìä∏ Î≤ÑÌäº ÌÅ¥Î¶≠Îê®!');
                    testDALLE();
                });
            } else {
                console.error('‚ùå DALL-E ÌÖåÏä§Ìä∏ Î≤ÑÌäºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
            }
            
            // ÏÉùÏÑ± Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            const generateBtn = document.getElementById('generateButton');
            if (generateBtn) {
                console.log('‚úÖ ÏÉùÏÑ± Î≤ÑÌäº Ï∞æÏùå');
                generateBtn.addEventListener('click', function() {
                    console.log('üöÄ ÏÉùÏÑ± Î≤ÑÌäº ÌÅ¥Î¶≠Îê®!');
                    if (!generateBtn.disabled) {
                        finalizedStartAutoGeneration();
                    }
                });
            } else {
                console.error('‚ùå ÏÉùÏÑ± Î≤ÑÌäºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
            }
            
            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
            document.addEventListener('keydown', function(e) {
                if (generatedSlides.length > 0) {
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        prevSlide();
                    }
                    if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        nextSlide();
                    }
                    if (e.key === ' ') {
                        e.preventDefault();
                        toggleAutoPlay();
                    }
                }
                
                // Ctrl+EnterÎ°ú ÏÉùÏÑ± ÏãúÏûë
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    if (generateBtn && !generateBtn.disabled) {
                        finalizedStartAutoGeneration();
                    }
                }
            });
            
            // ÏûÖÎ†• ÌïÑÎìú Î≥ÄÌôî Í∞êÏßÄ
            const inputs = ['viralKeyword', 'contentTitle', 'contentDescription', 'manualTitle', 'manualContent'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', updateGenerateButton);
                    console.log(`‚úÖ ${id} ÏûÖÎ†• ÌïÑÎìú Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞Îê®`);
                }
            });
            
            // ÏÑ§Ï†ï Î≥ÄÌôî Í∞êÏßÄ
            const selects = ['channelType', 'contentTone', 'slideCount', 'visualStyle', 'animationStyle', 'backgroundMusic'];
            selects.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        generationConfig[id] = this.value;
                        saveSettings();
                    });
                    console.log(`‚úÖ ${id} ÏÑ†ÌÉù ÌïÑÎìú Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞Îê®`);
                }
            });
            
            console.log('‚úÖ Î™®Îì† Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        // ===== API ÌÇ§ Ïã§ÏãúÍ∞Ñ Í≤ÄÏ¶ù ÏãúÏä§ÌÖú (Í∞ïÌôîÎê®) =====
        function initializeAPIKeyValidation() {
            console.log('üîë API ÌÇ§ Í≤ÄÏ¶ù ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî');
            
            const keyInput = document.getElementById('openaiKey');
            const connectBtn = document.getElementById('connectOpenAIBtn');
            
            if (!keyInput) {
                console.error('‚ùå API ÌÇ§ ÏûÖÎ†• ÌïÑÎìúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå');
                return;
            }
            
            if (!connectBtn) {
                console.error('‚ùå Ïó∞Í≤∞ Î≤ÑÌäºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
                return;
            }
            
            console.log('‚úÖ API ÌÇ§ ÏûÖÎ†• ÌïÑÎìúÏôÄ Ïó∞Í≤∞ Î≤ÑÌäº Ï∞æÏùå');
            
            // Ï¥àÍ∏∞ ÏÉÅÌÉú ÏÑ§Ï†ï
            connectBtn.disabled = true;
            showStatus('üìù API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'warning', 'openaiStatus');
            
            // Ïã§ÏãúÍ∞Ñ ÌÇ§ Í≤ÄÏ¶ù
            keyInput.addEventListener('input', function() {
                const key = this.value.trim();
                console.log('‚å®Ô∏è API ÌÇ§ ÏûÖÎ†• Í∞êÏßÄ:', key ? 'ÏûÖÎ†•Îê®' : 'ÎπÑÏñ¥ÏûàÏùå');
                validateAPIKeyFormat(key);
            });
            
            // Î∂ôÏó¨ÎÑ£Í∏∞ Í∞êÏßÄ
            keyInput.addEventListener('paste', function() {
                setTimeout(() => {
                    const key = this.value.trim();
                    console.log('üìã API ÌÇ§ Î∂ôÏó¨ÎÑ£Í∏∞ Í∞êÏßÄ:', key ? 'ÏûÖÎ†•Îê®' : 'ÎπÑÏñ¥ÏûàÏùå');
                    validateAPIKeyFormat(key);
                }, 100);
            });
            
            console.log('‚úÖ API ÌÇ§ Í≤ÄÏ¶ù ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        function validateAPIKeyFormat(key) {
            const connectBtn = document.getElementById('connectOpenAIBtn');
            
            if (!key) {
                showStatus('üìù API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'warning', 'openaiStatus');
                if (connectBtn) {
                    connectBtn.disabled = true;
                    connectBtn.style.background = 'rgba(255,255,255,0.3)';
                    connectBtn.style.animation = 'none';
                }
                return false;
            }
            
            if (!key.startsWith('sk-')) {
                showStatus('‚ùå API ÌÇ§Îäî "sk-"Î°ú ÏãúÏûëÌï¥Ïïº Ìï©ÎãàÎã§', 'error', 'openaiStatus');
                if (connectBtn) {
                    connectBtn.disabled = true;
                    connectBtn.style.background = 'rgba(255,0,0,0.3)';
                    connectBtn.style.animation = 'none';
                }
                return false;
            }
            
            if (key.length < 40) {
                showStatus('‚ùå API ÌÇ§Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§ (ÏµúÏÜå 40Ïûê)', 'error', 'openaiStatus');
                if (connectBtn) {
                    connectBtn.disabled = true;
                    connectBtn.style.background = 'rgba(255,165,0,0.3)';
                    connectBtn.style.animation = 'none';
                }
                return false;
            }
            
            if (key.length > 200) {
                showStatus('‚ùå API ÌÇ§Í∞Ä ÎÑàÎ¨¥ ÍπÅÎãàÎã§', 'error', 'openaiStatus');
                if (connectBtn) {
                    connectBtn.disabled = true;
                    connectBtn.style.background = 'rgba(255,0,0,0.3)';
                    connectBtn.style.animation = 'none';
                }
                return false;
            }
            
            // ÌòïÏãùÏù¥ Ïò¨Î∞îÎ•∏ Í≤ΩÏö∞
            showStatus('‚úÖ API ÌÇ§ ÌòïÏãùÏù¥ Ïò¨Î∞îÎ¶ÖÎãàÎã§. Ïó∞Í≤∞ Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî!', 'success', 'openaiStatus');
            if (connectBtn) {
                connectBtn.disabled = false;
                connectBtn.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                connectBtn.style.animation = 'pulse 2s infinite';
                console.log('‚úÖ Ïó∞Í≤∞ Î≤ÑÌäº ÌôúÏÑ±ÌôîÎê®');
            }
            return true;
        }

        // ===== ÎîîÎ≤ÑÍπÖÏö© Î≤ÑÌäº ÌÅ¥Î¶≠ ÌÖåÏä§Ìä∏ =====
        function testButtonClick() {
            console.log('üß™ Î≤ÑÌäº ÌÅ¥Î¶≠ ÌÖåÏä§Ìä∏ Ìï®Ïàò Ìò∏Ï∂úÎê®');
            alert('Î≤ÑÌäºÏù¥ Ï†ïÏÉÅÏ†ÅÏúºÎ°ú ÌÅ¥Î¶≠ÎêòÏóàÏäµÎãàÎã§!');
        }

        // ===== Í∞ïÏ†ú Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ìï®Ïàò =====
        function forceTestConnection() {
            console.log('üîß Í∞ïÏ†ú Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ ÏãúÏûë');
            const keyInput = document.getElementById('openaiKey');
            if (keyInput && keyInput.value.trim()) {
                connectOpenAI();
            } else {
                console.log('‚ùå API ÌÇ§Í∞Ä ÏûÖÎ†•ÎêòÏßÄ ÏïäÏùå');
                alert('Î®ºÏ†Ä API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
            }
        }

        // Ï†ÄÏû•Îêú ÏÑ§Ï†ï Î°úÎìú
        function loadSavedSettings() {
            try {
                const saved = localStorage.getItem('youtubeGeneratorSettings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    Object.assign(generationConfig, settings);
                    
                    // UI ÏóÖÎç∞Ïù¥Ìä∏
                    Object.keys(settings).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) element.value = settings[key];
                    });
                }
            } catch (error) {
                console.warn('ÏÑ§Ï†ï Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // ÏÑ§Ï†ï Ï†ÄÏû•
        function saveSettings() {
            try {
                localStorage.setItem('youtubeGeneratorSettings', JSON.stringify(generationConfig));
            } catch (error) {
                console.warn('ÏÑ§Ï†ï Ï†ÄÏû• Ïã§Ìå®:', error);
            }
        }

        // ÌååÌã∞ÌÅ¥ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
        function initializeParticles() {
            const container = document.getElementById('floatingParticles');
            if (!container) return;
            
            // Í∏∞Ï°¥ ÌååÌã∞ÌÅ¥ Ï†úÍ±∞
            container.innerHTML = '';
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (6 + Math.random() * 4) + 's';
                
                // ÌååÌã∞ÌÅ¥ ÏÉâÏÉÅ ÎûúÎç§Ìôî
                const colors = ['rgba(255,255,255,0.6)', 'rgba(78,205,196,0.6)', 'rgba(255,107,107,0.6)', 'rgba(254,202,87,0.6)'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                container.appendChild(particle);
            }
        }

        // ===== GPT Î™®Îç∏ Î∞è ÏÉùÏÑ± Î™®Îìú Í¥ÄÎ¶¨ =====
        function selectGPTModel(model) {
            selectedGPTModel = model;
            
            document.querySelectorAll('#gpt4oCard, #gpt4Card').forEach(card => {
                card.classList.remove('selected');
            });
            
            const selectedCard = document.getElementById(model === 'gpt-4o' ? 'gpt4oCard' : 'gpt4Card');
            if (selectedCard) selectedCard.classList.add('selected');
            
            console.log('ÏÑ†ÌÉùÎêú GPT Î™®Îç∏:', selectedGPTModel);
            updateGenerateButton();
        }

        function selectGenerationMode(mode) {
            selectedGenerationMode = mode;
            
            // Î™®Îì† Î™®Îìú Ïπ¥ÎìúÏóêÏÑú selected ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.mode-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // ÏÑ†ÌÉùÎêú Î™®Îìú Ïπ¥ÎìúÏóê selected ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
            const selectedCard = document.getElementById(mode.replace('-', '') + 'Mode');
            if (selectedCard) selectedCard.classList.add('selected');
            
            // ÏûÖÎ†• ÌïÑÎìú ÌëúÏãú/Ïà®ÍπÄ
            document.querySelectorAll('.mode-inputs').forEach(input => {
                input.classList.add('hidden');
            });
            
            const targetInput = document.getElementById(mode.replace('-', '') + 'ModeInputs');
            if (targetInput) targetInput.classList.remove('hidden');
            
            updateGenerateButton();
            console.log('ÏÑ†ÌÉùÎêú ÏÉùÏÑ± Î™®Îìú:', selectedGenerationMode);
        }

        // ===== Ïã§ÏãúÍ∞Ñ API ÌÇ§ Í≤ÄÏ¶ù ÏãúÏä§ÌÖú =====
        function initializeAPIKeyValidation() {
            const keyInput = document.getElementById('openaiKey');
            if (!keyInput) return;
            
            // Ïã§ÏãúÍ∞Ñ ÌÇ§ Í≤ÄÏ¶ù
            keyInput.addEventListener('input', function() {
                const key = this.value.trim();
                validateAPIKeyFormat(key);
            });
            
            // Î∂ôÏó¨ÎÑ£Í∏∞ Í∞êÏßÄ
            keyInput.addEventListener('paste', function() {
                setTimeout(() => {
                    const key = this.value.trim();
                    validateAPIKeyFormat(key);
                }, 100);
            });
        }

        function validateAPIKeyFormat(key) {
            const statusElement = document.getElementById('openaiStatus');
            const connectButton = document.querySelector('button[onclick="connectOpenAI()"]');
            
            if (!key) {
                showStatus('üìù API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'warning', 'openaiStatus');
                if (connectButton) connectButton.disabled = true;
                return false;
            }
            
            if (!key.startsWith('sk-')) {
                showStatus('‚ùå API ÌÇ§Îäî "sk-"Î°ú ÏãúÏûëÌï¥Ïïº Ìï©ÎãàÎã§', 'error', 'openaiStatus');
                if (connectButton) connectButton.disabled = true;
                return false;
            }
            
            if (key.length < 40) {
                showStatus('‚ùå API ÌÇ§Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§ (ÏµúÏÜå 40Ïûê)', 'error', 'openaiStatus');
                if (connectButton) connectButton.disabled = true;
                return false;
            }
            
            if (key.length > 200) {
                showStatus('‚ùå API ÌÇ§Í∞Ä ÎÑàÎ¨¥ ÍπÅÎãàÎã§', 'error', 'openaiStatus');
                if (connectButton) connectButton.disabled = true;
                return false;
            }
            
            // ÌòïÏãùÏù¥ Ïò¨Î∞îÎ•∏ Í≤ΩÏö∞
            showStatus('‚úÖ API ÌÇ§ ÌòïÏãùÏù¥ Ïò¨Î∞îÎ¶ÖÎãàÎã§. Ïó∞Í≤∞ Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî!', 'success', 'openaiStatus');
            if (connectButton) {
                connectButton.disabled = false;
                connectButton.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                connectButton.style.animation = 'pulse 2s infinite';
            }
            return true;
        }

        // ===== Í∞úÏÑ†Îêú OpenAI API Ïó∞Í≤∞ ÏãúÏä§ÌÖú =====
        async function connectOpenAI() {
            const keyInput = document.getElementById('openaiKey');
            const connectButton = document.querySelector('button[onclick="connectOpenAI()"]');
            
            if (!keyInput) {
                console.error('‚ùå API ÌÇ§ ÏûÖÎ†• ÌïÑÎìúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                alert('‚ùå ÏãúÏä§ÌÖú Ïò§Î•ò: API ÌÇ§ ÏûÖÎ†• ÌïÑÎìúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const key = keyInput.value.trim();
            console.log('üîë API ÌÇ§ Ïó∞Í≤∞ ÏãúÎèÑ ÏãúÏûë');
            console.log('ÌÇ§ Í∏∏Ïù¥:', key.length);
            console.log('ÌÇ§ ÏãúÏûë Î∂ÄÎ∂Ñ:', key.substring(0, 10) + '...');
            
            // Î≤ÑÌäº ÏÉÅÌÉú Î≥ÄÍ≤Ω
            if (connectButton) {
                connectButton.disabled = true;
                connectButton.textContent = 'üîó Ïó∞Í≤∞ Ï§ë...';
                connectButton.style.background = 'linear-gradient(45deg, #feca57, #ff9ff3)';
            }
            
            // ÏµúÏ¢Ö ÌòïÏãù Í≤ÄÏ¶ù
            if (!validateAPIKeyFormat(key)) {
                if (connectButton) {
                    connectButton.disabled = false;
                    connectButton.textContent = 'üîó OpenAI Ïó∞Í≤∞';
                    connectButton.style.background = 'linear-gradient(45deg, #4facfe, #00f2fe)';
                }
                return;
            }
            
            showStatus('üîó OpenAI API Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ï§ë...', 'warning', 'openaiStatus');
            
            try {
                console.log('üåê API Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ ÏãúÏûë');
                
                // Í∞ÑÎã®Ìïú Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
                const testResponse = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${key}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [
                            {
                                role: 'user',
                                content: 'ÏïàÎÖïÌïòÏÑ∏Ïöî! Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ÏûÖÎãàÎã§. "Ïó∞Í≤∞ ÏÑ±Í≥µ"Ïù¥ÎùºÍ≥† ÏßßÍ≤å ÎãµÌï¥Ï£ºÏÑ∏Ïöî.'
                            }
                        ],
                        max_tokens: 10,
                        temperature: 0
                    })
                });
                
                console.log('üì° API ÏùëÎãµ ÏÉÅÌÉú:', testResponse.status);
                
                if (testResponse.ok) {
                    const data = await testResponse.json();
                    console.log('‚úÖ API Ïó∞Í≤∞ ÏÑ±Í≥µ!');
                    console.log('ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', data);
                    
                    // Ï†ÑÏó≠ Î≥ÄÏàòÏóê Ï†ÄÏû•
                    openaiApiKey = key;
                    
                    // Ïó∞Í≤∞ ÏÑ±Í≥µ UI ÏóÖÎç∞Ïù¥Ìä∏
                    updateConnectionSuccessUI();
                    
                    // ÏÑ±Í≥µ Î©îÏãúÏßÄ
                    showStatus('üéâ OpenAI API Ïó∞Í≤∞ ÏôÑÎ£å! GPT-4ÏôÄ DALL-E 3 ÏÇ¨Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§.', 'success', 'openaiStatus');
                    
                    // ÏÉùÏÑ± Î≤ÑÌäº ÌôúÏÑ±Ìôî
                    updateGenerateButton();
                    
                    // ÏÑ±Í≥µ ÏïåÎ¶º
                    showSuccessNotification('üéâ OpenAI API Ïó∞Í≤∞ ÏÑ±Í≥µ! Ïù¥Ï†ú ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏†Î•º ÎßåÎì§ Ïàò ÏûàÏäµÎãàÎã§!');
                    
                } else {
                    // Ïã§Ìå® Ï≤òÎ¶¨
                    const errorData = await testResponse.json().catch(() => ({}));
                    console.error('‚ùå API Ïó∞Í≤∞ Ïã§Ìå®:', testResponse.status, errorData);
                    
                    handleAPIConnectionError(testResponse.status, errorData);
                }
                
            } catch (error) {
                console.error('üåê ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò:', error);
                handleNetworkError(error);
            } finally {
                // Î≤ÑÌäº ÏÉÅÌÉú Î≥µÏõê
                if (connectButton) {
                    connectButton.disabled = false;
                    connectButton.textContent = 'üîó OpenAI Ïó∞Í≤∞';
                    if (openaiApiKey) {
                        connectButton.textContent = '‚úÖ Ïó∞Í≤∞ ÏôÑÎ£å';
                        connectButton.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                    } else {
                        connectButton.style.background = 'linear-gradient(45deg, #4facfe, #00f2fe)';
                    }
                }
            }
        }

        // ===== Ïó∞Í≤∞ ÏÑ±Í≥µ UI ÏóÖÎç∞Ïù¥Ìä∏ =====
        function updateConnectionSuccessUI() {
            console.log('üé® Ïó∞Í≤∞ ÏÑ±Í≥µ UI ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë');
            
            // OpenAI Ïπ¥Îìú Ïó∞Í≤∞ ÏÉÅÌÉú ÌëúÏãú
            const openaiCard = document.getElementById('openaiCard');
            if (openaiCard) {
                openaiCard.classList.add('connected');
                openaiCard.style.borderColor = '#43e97b';
                openaiCard.style.background = 'rgba(67,233,123,0.1)';
                openaiCard.style.boxShadow = '0 0 30px rgba(67,233,123,0.3)';
            }
            
            // GPT ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            const gptStatus = document.getElementById('gptStatus');
            if (gptStatus) {
                gptStatus.innerHTML = `
                    <div style="font-size: 2em; margin-bottom: 10px; animation: bounce 2s infinite;">‚úÖ</div>
                    <div style="font-weight: bold; color: #43e97b;">GPT-4 Ïó∞Í≤∞ ÏôÑÎ£å</div>
                    <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">API Ï†ïÏÉÅ ÏûëÎèô</div>
                `;
                gptStatus.style.background = 'rgba(67,233,123,0.2)';
                gptStatus.style.borderColor = 'rgba(67,233,123,0.5)';
                gptStatus.style.transform = 'scale(1.02)';
            }
            
            // DALL-E ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            const dalleStatus = document.getElementById('dalleConnectionStatus');
            if (dalleStatus) {
                dalleStatus.innerHTML = `
                    <div style="font-size: 2em; margin-bottom: 10px; animation: bounce 2s infinite;">‚úÖ</div>
                    <div style="font-weight: bold; color: #43e97b;">DALL-E 3 Ïó∞Í≤∞ ÏôÑÎ£å</div>
                    <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ÄÎπÑÎê®</div>
                `;
                dalleStatus.style.background = 'rgba(67,233,123,0.2)';
                dalleStatus.style.borderColor = 'rgba(67,233,123,0.5)';
                dalleStatus.style.transform = 'scale(1.02)';
            }
            
            console.log('‚úÖ Ïó∞Í≤∞ ÏÑ±Í≥µ UI ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å');
        }

        // ===== API Ïó∞Í≤∞ Ïò§Î•ò Ï≤òÎ¶¨ =====
        function handleAPIConnectionError(status, errorData) {
            let errorMessage = '‚ùå API Ïó∞Í≤∞ Ïã§Ìå®: ';
            let suggestion = '';
            
            switch (status) {
                case 401:
                    errorMessage += 'API ÌÇ§Í∞Ä Ïú†Ìö®ÌïòÏßÄ ÏïäÏäµÎãàÎã§.';
                    suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: OpenAI ÏõπÏÇ¨Ïù¥Ìä∏ÏóêÏÑú ÏÉàÎ°úÏö¥ API ÌÇ§Î•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.';
                    break;
                case 403:
                    errorMessage += 'API Ï†ëÍ∑ºÏù¥ Í±∞Î∂ÄÎêòÏóàÏäµÎãàÎã§.';
                    suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: Í≥ÑÏ†ï ÏÉÅÌÉúÎ•º ÌôïÏù∏ÌïòÍ±∞ÎÇò Í≤∞Ï†ú Ï†ïÎ≥¥Î•º ÏóÖÎç∞Ïù¥Ìä∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                    break;
                case 429:
                    errorMessage += 'ÏöîÏ≤≠ ÌïúÎèÑÎ•º Ï¥àÍ≥ºÌñàÏäµÎãàÎã§.';
                    suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌïòÍ±∞ÎÇò ÌîåÎûúÏùÑ ÏóÖÍ∑∏Î†àÏù¥ÎìúÌï¥Ï£ºÏÑ∏Ïöî.';
                    break;
                case 500:
                case 502:
                case 503:
                    errorMessage += 'OpenAI ÏÑúÎ≤ÑÏóê ÏùºÏãúÏ†ÅÏù∏ Î¨∏Ï†úÍ∞Ä ÏûàÏäµÎãàÎã§.';
                    suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: 1-2Î∂Ñ ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                    break;
                default:
                    errorMessage += `Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò (ÏÉÅÌÉú ÏΩîÎìú: ${status})`;
                    suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
            }
            
            if (errorData.error && errorData.error.message) {
                errorMessage += `\nÏÉÅÏÑ∏ Ïò§Î•ò: ${errorData.error.message}`;
            }
            
            showStatus(errorMessage, 'error', 'openaiStatus');
            
            // Ï∂îÍ∞Ä ÎèÑÏõÄÎßê ÌëúÏãú
            setTimeout(() => {
                const statusElement = document.getElementById('openaiStatus');
                if (statusElement) {
                    statusElement.innerHTML += `<br><small style="opacity: 0.8;">${suggestion}</small>`;
                }
            }, 1000);
        }

        // ===== ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò Ï≤òÎ¶¨ =====
        function handleNetworkError(error) {
            let errorMessage = 'üåê ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ Ïò§Î•ò: ';
            let suggestion = '';
            
            if (error.name === 'TypeError' && error.message.includes('fetch')) {
                errorMessage += 'Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: Wi-Fi ÎòêÎäî Îç∞Ïù¥ÌÑ∞ Ïó∞Í≤∞ ÏÉÅÌÉúÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
            } else if (error.message.includes('CORS')) {
                errorMessage += 'CORS Ï†ïÏ±Ö Ïò§Î•òÏûÖÎãàÎã§.';
                suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÍ±∞ÎÇò Îã§Î•∏ Î∏åÎùºÏö∞Ï†ÄÎ•º ÏÇ¨Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî.';
            } else if (error.message.includes('timeout')) {
                errorMessage += 'Ïó∞Í≤∞ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§.';
                suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: ÎÑ§Ìä∏ÏõåÌÅ¨ ÏÉÅÌÉúÎ•º ÌôïÏù∏ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
            } else {
                errorMessage += 'Ïïå Ïàò ÏóÜÎäî ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•òÏûÖÎãàÎã§.';
                suggestion = 'üí° Ìï¥Í≤∞Î∞©Î≤ï: Î∏åÎùºÏö∞Ï†ÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
            }
            
            showStatus(errorMessage, 'error', 'openaiStatus');
            
            // Ï∂îÍ∞Ä ÎèÑÏõÄÎßê ÌëúÏãú
            setTimeout(() => {
                const statusElement = document.getElementById('openaiStatus');
                if (statusElement) {
                    statusElement.innerHTML += `<br><small style="opacity: 0.8;">${suggestion}</small>`;
                }
            }, 1000);
        }

        // ===== DALL-E 3 ÌÖåÏä§Ìä∏ Í∞úÏÑ† =====
        async function testDALLE() {
            if (!openaiApiKey) {
                showStatus('‚ùå Î®ºÏ†Ä OpenAI APIÎ•º Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî.', 'error', 'dalleStatus');
                return;
            }
            
            const testButton = document.querySelector('button[onclick="testDALLE()"]');
            if (testButton) {
                testButton.disabled = true;
                testButton.textContent = 'üé® ÌÖåÏä§Ìä∏ Ï§ë...';
            }
            
            showStatus('üé® DALL-E 3 ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë...', 'warning', 'dalleStatus');
            
            try {
                const testPrompt = 'A beautiful modern YouTube studio with neon lights, high-tech equipment, vibrant colors, professional setup, digital art style';
                const imageUrl = await generateImageWithDALLE(testPrompt, 'hd', '1024x1024', 'vivid');
                
                if (imageUrl) {
                    showStatus('‚úÖ DALL-E 3 Ïó∞Í≤∞ ÏÑ±Í≥µ!', 'success', 'dalleStatus');
                    
                    // ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÌëúÏãú
                    const dalleCard = document.getElementById('dalleCard');
                    if (dalleCard) {
                        // Í∏∞Ï°¥ ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ Ï†úÍ±∞
                        const existingImage = dalleCard.querySelector('.dalle-test-image');
                        if (existingImage) existingImage.remove();
                        
                        const testImageDiv = document.createElement('div');
                        testImageDiv.className = 'dalle-test-image';
                        testImageDiv.innerHTML = `
                            <div style="margin-top: 20px; text-align: center; padding: 15px; background: rgba(67,233,123,0.1); border-radius: 15px; border: 2px solid rgba(67,233,123,0.3);">
                                <h4 style="color: #43e97b; margin-bottom: 15px;">üé® ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏôÑÎ£å!</h4>
                                <img src="${imageUrl}" style="max-width: 200px; max-height: 200px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); cursor: pointer;" onclick="window.open('${imageUrl}', '_blank')">
                                <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">ÌÅ¥Î¶≠ÌïòÎ©¥ ÌÅ¨Í≤å Î≥º Ïàò ÏûàÏäµÎãàÎã§</p>
                            </div>
                        `;
                        dalleCard.appendChild(testImageDiv);
                    }
                    
                    showSuccessNotification('üé® DALL-E 3 ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ! ÏôÑÎ≤ΩÌïú Ïù¥ÎØ∏ÏßÄÎ•º ÏÉùÏÑ±Ìï† Ïàò ÏûàÏäµÎãàÎã§!');
                    
                } else {
                    throw new Error('Ïù¥ÎØ∏ÏßÄ URLÏùÑ Î∞õÏßÄ Î™ªÌñàÏäµÎãàÎã§.');
                }
                
            } catch (error) {
                console.error('DALL-E 3 ÌÖåÏä§Ìä∏ Ïò§Î•ò:', error);
                showStatus('‚ùå DALL-E 3 ÌÖåÏä§Ìä∏ Ïã§Ìå®: ' + error.message, 'error', 'dalleStatus');
            } finally {
                if (testButton) {
                    testButton.disabled = false;
                    testButton.textContent = 'üé® DALL-E 3 ÌÖåÏä§Ìä∏';
                }
            }
        }

        // ===== Í∞úÏÑ†Îêú Ï¥àÍ∏∞Ìôî ÏãúÏä§ÌÖú =====
        function initializeEnhancedAPISystem() {
            console.log('üöÄ Ìñ•ÏÉÅÎêú API ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî');
            
            // API ÌÇ§ Ïã§ÏãúÍ∞Ñ Í≤ÄÏ¶ù Ï¥àÍ∏∞Ìôî
            initializeAPIKeyValidation();
            
            // Í∏∞Ï°¥ Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏
            if (openaiApiKey) {
                console.log('üîÑ Í∏∞Ï°¥ API ÌÇ§ Î∞úÍ≤¨, Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ Ï§ë...');
                updateConnectionSuccessUI();
                updateGenerateButton();
            }
            
            console.log('‚úÖ Ìñ•ÏÉÅÎêú API ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        // ===== Í∏∞Ï°¥ Ï¥àÍ∏∞ÌôîÏóê Ï∂îÍ∞Ä =====
        document.addEventListener('DOMContentLoaded', function() {
            // Í∏∞Ï°¥ Ï¥àÍ∏∞Ìôî Ìï®ÏàòÎì§...
            initializeParticles();
            initializeEventListeners();
            updateGenerateButton();
            loadSavedSettings();
            
            // ÏÉàÎ°úÏö¥ API ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ï∂îÍ∞Ä
            initializeEnhancedAPISystem();
            
            console.log('‚úÖ Ï†ÑÏ≤¥ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        });

        // ===== Ìñ•ÏÉÅÎêú OpenAI API Ìò∏Ï∂ú ÏãúÏä§ÌÖú =====
        async function callOpenAI(prompt, model = null, maxTokens = 2000, temperature = 0.7) {
            if (!openaiApiKey) {
                throw new Error('API ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
            }
            
            const modelToUse = model || selectedGPTModel;
            console.log(`OpenAI API Ìò∏Ï∂ú: ${modelToUse}, ÌÜ†ÌÅ∞: ${maxTokens}`);
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${openaiApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: modelToUse,
                        messages: [
                            {
                                role: 'system',
                                content: 'ÎãπÏã†ÏùÄ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. 100ÎßåÎ∑∞Î•º ÎßåÎìúÎäî ÏΩòÌÖêÏ∏† Ï†úÏûëÏóê ÌäπÌôîÎêòÏñ¥ ÏûàÏäµÎãàÎã§.'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        max_tokens: maxTokens,
                        temperature: temperature
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    
                    let errorMessage = `API Ïò§Î•ò ${response.status}`;
                    if (errorData.error && errorData.error.message) {
                        errorMessage += `: ${errorData.error.message}`;
                    }
                    
                    throw new Error(errorMessage);
                }
                
                const data = await response.json();
                const result = data.choices[0]?.message?.content || '';
                
                console.log('OpenAI API ÏùëÎãµ ÏÑ±Í≥µ, Í∏∏Ïù¥:', result.length);
                return result;
                
            } catch (error) {
                console.error('OpenAI API Ìò∏Ï∂ú Ïò§Î•ò:', error);
                throw error;
            }
        }

        // ===== Ìñ•ÏÉÅÎêú DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏãúÏä§ÌÖú =====
        async function generateImageWithDALLE(prompt, quality = 'hd', size = '1024x1792', style = 'vivid') {
            if (!openaiApiKey) {
                throw new Error('OpenAI API ÌÇ§Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.');
            }
            
            console.log(`DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±: ${quality}, ${size}, ${style}`);
            
            try {
                const response = await fetch('https://api.openai.com/v1/images/generations', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${openaiApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'dall-e-3',
                        prompt: prompt,
                        n: 1,
                        quality: quality,
                        size: size,
                        style: style
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    
                    let errorMessage = `DALL-E Ïò§Î•ò ${response.status}`;
                    if (errorData.error && errorData.error.message) {
                        errorMessage += `: ${errorData.error.message}`;
                    }
                    
                    throw new Error(errorMessage);
                }
                
                const data = await response.json();
                const imageUrl = data.data[0]?.url;
                
                if (imageUrl) {
                    console.log('DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏÑ±Í≥µ');
                    return imageUrl;
                } else {
                    throw new Error('Ïù¥ÎØ∏ÏßÄ URLÏùÑ Î∞õÏßÄ Î™ªÌñàÏäµÎãàÎã§.');
                }
                
            } catch (error) {
                console.error('DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïò§Î•ò:', error);
                throw error;
            }
        }

        // ===== OpenAI API Ìò∏Ï∂ú ÏãúÏä§ÌÖú =====
        async function callOpenAI(prompt, model = null, maxTokens = 2000, temperature = 0.7) {
            if (!openaiApiKey) {
                throw new Error('API ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
            }
            
            const modelToUse = model || selectedGPTModel;
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${openaiApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: modelToUse,
                        messages: [
                            {
                                role: 'system',
                                content: 'ÎãπÏã†ÏùÄ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. 100ÎßåÎ∑∞Î•º ÎßåÎìúÎäî ÏΩòÌÖêÏ∏† Ï†úÏûëÏóê ÌäπÌôîÎêòÏñ¥ ÏûàÏäµÎãàÎã§.'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        max_tokens: maxTokens,
                        temperature: temperature
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`API Ïò§Î•ò ${response.status}: ${errorData.error?.message || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`);
                }
                
                const data = await response.json();
                return data.choices[0]?.message?.content || '';
                
            } catch (error) {
                console.error('OpenAI API Ìò∏Ï∂ú Ïò§Î•ò:', error);
                throw error;
            }
        }

        // ===== DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏãúÏä§ÌÖú =====
        async function generateImageWithDALLE(prompt, quality = 'hd', size = '1024x1792', style = 'vivid') {
            if (!openaiApiKey) {
                throw new Error('OpenAI API ÌÇ§Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.');
            }
            
            try {
                const response = await fetch('https://api.openai.com/v1/images/generations', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${openaiApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'dall-e-3',
                        prompt: prompt,
                        n: 1,
                        quality: quality,
                        size: size,
                        style: style
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`DALL-E Ïò§Î•ò ${response.status}: ${errorData.error?.message || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`);
                }
                
                const data = await response.json();
                return data.data[0]?.url || null;
                
            } catch (error) {
                console.error('DALL-E 3 Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïò§Î•ò:', error);
                throw error;
            }
        }

        // DALL-E 3 ÌÖåÏä§Ìä∏
        async function testDALLE() {
            if (!openaiApiKey) {
                showStatus('‚ùå Î®ºÏ†Ä OpenAI APIÎ•º Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî.', 'error', 'dalleStatus');
                return;
            }
            
            showStatus('üé® DALL-E 3 ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë...', 'warning', 'dalleStatus');
            
            try {
                const testPrompt = 'A futuristic YouTube studio with holographic screens, vibrant neon colors, modern technology, highly detailed, digital art style';
                const imageUrl = await generateImageWithDALLE(testPrompt, 'hd', '1024x1024', 'vivid');
                
                if (imageUrl) {
                    showStatus('‚úÖ DALL-E 3 Ïó∞Í≤∞ ÏÑ±Í≥µ!', 'success', 'dalleStatus');
                    
                    // ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÌëúÏãú
                    const testImageDiv = document.createElement('div');
                    testImageDiv.innerHTML = `
                        <div style="margin-top: 20px; text-align: center;">
                            <h4 style="color: #4ecdc4;">üé® ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏôÑÎ£å!</h4>
                            <img src="${imageUrl}" style="max-width: 200px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                        </div>
                    `;
                    document.getElementById('dalleCard').appendChild(testImageDiv);
                    
                } else {
                    throw new Error('Ïù¥ÎØ∏ÏßÄ URLÏùÑ Î∞õÏßÄ Î™ªÌñàÏäµÎãàÎã§.');
                }
                
            } catch (error) {
                console.error('DALL-E 3 ÌÖåÏä§Ìä∏ Ïò§Î•ò:', error);
                showStatus('‚ùå DALL-E 3 ÌÖåÏä§Ìä∏ Ïã§Ìå®: ' + error.message, 'error', 'dalleStatus');
            }
        }

        // ===== Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† Î∂ÑÏÑù ÏóîÏßÑ =====
        function analyzeViralPotential(content, channelType) {
            const patterns = viralPatterns[channelType] || viralPatterns.educational;
            let score = 0;
            let analysis = {
                hooks: 0,
                emotions: 0,
                keywords: 0,
                structure: 0,
                recommendations: []
            };
            
            const contentLower = content.toLowerCase();
            
            // ÌõÖ Î∂ÑÏÑù
            patterns.hooks.forEach(hook => {
                if (contentLower.includes(hook)) {
                    analysis.hooks += 25;
                    score += 25;
                }
            });
            
            // Í∞êÏ†ï ÌÇ§ÏõåÎìú Î∂ÑÏÑù
            patterns.emotions.forEach(emotion => {
                if (contentLower.includes(emotion)) {
                    analysis.emotions += 20;
                    score += 20;
                }
            });
            
            // Î∞îÏù¥Îü¥ ÌÇ§ÏõåÎìú Î∂ÑÏÑù
            patterns.keywords.forEach(keyword => {
                if (contentLower.includes(keyword)) {
                    analysis.keywords += 15;
                    score += 15;
                }
            });
            
            // Ï∂îÏ≤úÏÇ¨Ìï≠ ÏÉùÏÑ±
            if (analysis.hooks < 50) {
                analysis.recommendations.push('Îçî Í∞ïÎ†•Ìïú ÌõÖ ÌïÑÏöî');
            }
            if (analysis.emotions < 40) {
                analysis.recommendations.push('Í∞êÏ†ïÏ†Å ÏöîÏÜå Í∞ïÌôî');
            }
            if (analysis.keywords < 30) {
                analysis.recommendations.push('Î∞îÏù¥Îü¥ ÌÇ§ÏõåÎìú Ï∂îÍ∞Ä');
            }
            
            return {
                score: Math.min(100, score),
                analysis: analysis,
                rating: score > 80 ? 'üî• Î∞îÏù¥Îü¥ Í∞ÄÎä•ÏÑ± ÎÜíÏùå' : 
                       score > 60 ? '‚ö° Í¥úÏ∞ÆÏùÄ ÏΩòÌÖêÏ∏†' : 
                       score > 40 ? 'üìà Í∞úÏÑ† ÌïÑÏöî' : 'üîß ÎåÄÌè≠ ÏàòÏ†ï ÌïÑÏöî'
            };
        }

        // ===== ÏÉùÏÑ± Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ =====
        function updateGenerateButton() {
            const generateButton = document.getElementById('generateButton');
            if (!generateButton) return;
            
            let canGenerate = false;
            let buttonText = 'üöÄ 100ÎßåÎ∑∞ ÏΩòÌÖêÏ∏† ÏûêÎèô ÏÉùÏÑ±ÌïòÍ∏∞';
            
            // API Ïó∞Í≤∞ ÌôïÏù∏
            if (!openaiApiKey) {
                buttonText = '‚ùå OpenAI API Ïó∞Í≤∞ ÌïÑÏöî';
                canGenerate = false;
            } else {
                // Î™®ÎìúÎ≥Ñ ÏûÖÎ†•Í∞í ÌôïÏù∏
                if (selectedGenerationMode === 'auto') {
                    const keyword = document.getElementById('viralKeyword')?.value?.trim();
                    if (keyword && keyword.length > 2) {
                        canGenerate = true;
                        buttonText = `ü§ñ "${keyword}" Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† ÏûêÎèô ÏÉùÏÑ±`;
                    } else {
                        buttonText = 'üìù ÌÇ§ÏõåÎìú ÏûÖÎ†• ÌïÑÏöî';
                    }
                } else if (selectedGenerationMode === 'semi-auto') {
                    const title = document.getElementById('contentTitle')?.value?.trim();
                    const desc = document.getElementById('contentDescription')?.value?.trim();
                    if (title && desc && title.length > 3 && desc.length > 10) {
                        canGenerate = true;
                        buttonText = `üé® "${title}" ÏΩòÌÖêÏ∏† + AI Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±`;
                    } else {
                        buttonText = 'üìù Ï†úÎ™©Í≥º ÎÇ¥Ïö© ÏûÖÎ†• ÌïÑÏöî';
                    }
                } else if (selectedGenerationMode === 'manual') {
                    const title = document.getElementById('manualTitle')?.value?.trim();
                    const content = document.getElementById('manualContent')?.value?.trim();
                    if (title && content && title.length > 3 && content.length > 10) {
                        canGenerate = true;
                        buttonText = `üìù "${title}" Ïä¨ÎùºÏù¥Îìú ÏÉùÏÑ±`;
                    } else {
                        buttonText = 'üìù Ï†úÎ™©Í≥º ÎÇ¥Ïö© ÏûÖÎ†• ÌïÑÏöî';
                    }
                }
            }
            
            generateButton.disabled = !canGenerate;
            generateButton.textContent = buttonText;
            
            if (canGenerate) {
                generateButton.classList.add('pulsing');
            } else {
                generateButton.classList.remove('pulsing');
            }
        }

        // ===== ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú ÏãúÏä§ÌÖú =====
        function showStatus(message, type, elementId) {
            const statusElement = document.getElementById(elementId);
            if (!statusElement) return;
            
            statusElement.textContent = message;
            statusElement.className = `status-message ${type}`;
            statusElement.style.display = 'block';
            
            // 3Ï¥à ÌõÑ ÏûêÎèô Ïà®ÍπÄ (ÏóêÎü¨Í∞Ä ÏïÑÎãå Í≤ΩÏö∞)
            if (type !== 'error') {
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 3000);
            }
        }

        // ===== ÏÑ±Í≥µ ÏïåÎ¶º ÏãúÏä§ÌÖú =====
        function showSuccessNotification(message = 'üéâ ÏûëÏóÖÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!') {
            const notification = document.createElement('div');
            notification.className = 'success-notification';
            notification.innerHTML = message;
            document.body.appendChild(notification);
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò ÏãúÏûë
            setTimeout(() => notification.classList.add('show'), 100);
            
            // 3Ï¥à ÌõÑ Ï†úÍ±∞
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 600);
            }, 3000);
        }

        // ===== ÏßÑÌñâ ÏÉÅÌô© Î™®Îã¨ ÏãúÏä§ÌÖú =====
        function showProgressModal(show = true) {
            const modal = document.getElementById('progressModal');
            if (modal) {
                modal.classList.toggle('show', show);
            }
        }

        function updateProgress(percent, title, description, icon = 'ü§ñ') {
            const elements = {
                fill: document.getElementById('progressFill'),
                text: document.getElementById('progressText'),
                title: document.getElementById('progressTitle'),
                desc: document.getElementById('progressDesc'),
                icon: document.getElementById('progressIcon')
            };
            
            if (elements.fill) elements.fill.style.width = Math.min(100, Math.max(0, percent)) + '%';
            if (elements.text) elements.text.textContent = Math.round(percent) + '%';
            if (elements.title) elements.title.textContent = title;
            if (elements.desc) elements.desc.textContent = description;
            if (elements.icon) elements.icon.textContent = icon;
            
            // ÏßÑÌñâÎ•†Ïóê Îî∞Î•∏ ÏÉâÏÉÅ Î≥ÄÌôî
            if (elements.fill) {
                if (percent >= 90) {
                    elements.fill.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                } else if (percent >= 70) {
                    elements.fill.style.background = 'linear-gradient(45deg, #feca57, #ff9ff3)';
                } else if (percent >= 50) {
                    elements.fill.style.background = 'linear-gradient(45deg, #4facfe, #00f2fe)';
                }
            }
        }

        // ===== Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§ =====
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function sanitizeText(text) {
            return text.replace(/[<>]/g, '').trim();
        }

        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength - 3) + '...';
        }

        function generateRandomId() {
            return 'id_' + Math.random().toString(36).substr(2, 9);
        }

        // ===== ÏóêÎü¨ Ï≤òÎ¶¨ ÏãúÏä§ÌÖú =====
        window.addEventListener('error', function(event) {
            console.error('Ï†ÑÏó≠ Ïò§Î•ò:', event.error);
            showStatus('‚ö†Ô∏è ÏòàÏÉÅÏπò Î™ªÌïú Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error', 'openaiStatus');
        });

        window.addEventListener('unhandledrejection', function(event) {
            console.error('Ï≤òÎ¶¨ÎêòÏßÄ ÏïäÏùÄ Promise Í±∞Î∂Ä:', event.reason);
            event.preventDefault();
        });

        // ===== 2Îã®Í≥Ñ: ÌôòÏÉÅÏ†ÅÏù∏ ÏûêÎèô ÏΩòÌÖêÏ∏† ÏÉùÏÑ± ÏóîÏßÑ =====
        
        // Î∞îÏù¥Îü¥ ÌîÑÎ°¨ÌîÑÌä∏ ÏóîÏßÄÎãàÏñ¥ÎßÅ ÏãúÏä§ÌÖú
        const viralPromptTemplates = {
            auto: {
                contentAnalysis: `ÎãπÏã†ÏùÄ 100ÎßåÎ∑∞ Ïú†ÌäúÎ∏å ÏáºÏ∏† Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. Îã§Ïùå ÌÇ§ÏõåÎìúÎ°ú Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏†Î•º ÎßåÎì§Ïñ¥Ï£ºÏÑ∏Ïöî:

ÌÇ§ÏõåÎìú: {keyword}
Ï±ÑÎÑê Ïú†Ìòï: {channelType}
ÌÜ§Ïï§Îß§ÎÑà: {contentTone}
Ïä¨ÎùºÏù¥Îìú Í∞úÏàò: {slideCount}Ïû•

Îã§Ïùå Î∞îÏù¥Îü¥ Í≥µÏãùÏùÑ Ï†ÅÏö©Ìï¥ÏÑú ÏΩòÌÖêÏ∏†Î•º ÎßåÎì§Ïñ¥Ï£ºÏÑ∏Ïöî:
1. Í∞ïÎ†•Ìïú ÌõÖ (Ï≤´ 3Ï¥à Í¥ÄÏã¨ ÎÅåÍ∏∞)
2. Ìò∏Í∏∞Ïã¨ Ïú†Î∞ú (Í≥ÑÏÜç Î≥¥Í≤å ÎßåÎì§Í∏∞)
3. Í∞êÏ†ïÏ†Å Ïó∞Í≤∞ (Í≥µÍ∞ê ÎòêÎäî ÎÜÄÎùºÏõÄ)
4. Î™ÖÌôïÌïú Í∞ÄÏπò Ï†úÍ≥µ (Î∞∞Ïö∏ Ï†êÏù¥ÎÇò Ïû¨ÎØ∏)
5. Í∞ïÎ†•Ìïú ÎßàÎ¨¥Î¶¨ (Í∏∞ÏñµÏóê ÎÇ®ÏùÑ Î©îÏãúÏßÄ)

JSON ÌòïÏãùÏúºÎ°úÎßå ÏùëÎãµÌï¥Ï£ºÏÑ∏Ïöî:
{
  "title": "Îß§Î†•Ï†ÅÏù¥Í≥† ÌÅ¥Î¶≠ÌïòÍ≥† Ïã∂ÏùÄ Ï†úÎ™© (10Îã®Ïñ¥ Ïù¥ÎÇ¥)",
  "hook": "Ï≤´ Ïä¨ÎùºÏù¥Îìú Í∞ïÎ†•Ìïú ÌõÖ Î¨∏Ïû•",
  "slides": [
    {
      "number": 1,
      "title": "Ïä¨ÎùºÏù¥Îìú Ï†úÎ™©",
      "content": "Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© (2-3Î¨∏Ïû•)",
      "emotion": "Ïú†Î∞úÌï† Í∞êÏ†ï",
      "visualKeywords": "Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±Ïö© ÌÇ§ÏõåÎìú"
    }
  ],
  "viralScore": 85,
  "hashtags": ["#Î∞îÏù¥Îü¥", "#Ïú†ÌäúÎ∏åÏáºÏ∏†"],
  "thumbnail": "Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄ ÏÑ§Î™Ö"
}`,

                imagePrompt: `Create a stunning YouTube Shorts thumbnail for "{title}". 
Style: {visualStyle}, vibrant colors, eye-catching design, {emotion} emotion.
Visual elements: {visualKeywords}
Format: Vertical 9:16 ratio, high contrast, bold text readable on mobile.
Quality: Professional, magazine-quality, trending on social media.`
            },

            semiAuto: {
                contentAnalysis: `ÎãπÏã†ÏùÄ Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏΩòÌÖêÏ∏† ÏµúÏ†ÅÌôî Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. 
Ï†úÎ™©: {title}
ÎÇ¥Ïö©: {content}
Ïä¨ÎùºÏù¥Îìú Í∞úÏàò: {slideCount}Ïû•

Ïù¥ ÎÇ¥Ïö©ÏùÑ Î∞îÏù¥Îü¥ Ïú†ÌäúÎ∏å ÏáºÏ∏†Ïö©ÏúºÎ°ú ÏµúÏ†ÅÌôîÌï¥ÏÑú {slideCount}Ïû•Ïùò Ïä¨ÎùºÏù¥ÎìúÎ°ú Íµ¨ÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.
Í∞Å Ïä¨ÎùºÏù¥ÎìúÎäî 3-5Ï¥à Î∂ÑÎüâÏúºÎ°ú ÏÑ§Í≥ÑÌïòÍ≥†, ÏãúÏ≤≠ÏûêÍ∞Ä ÎÅùÍπåÏßÄ Î≥¥ÎèÑÎ°ù ÎßåÎì§Ïñ¥Ï£ºÏÑ∏Ïöî.

JSON ÌòïÏãùÏúºÎ°úÎßå ÏùëÎãµÌï¥Ï£ºÏÑ∏Ïöî:
{
  "optimizedTitle": "ÏµúÏ†ÅÌôîÎêú Ï†úÎ™©",
  "hook": "Í∞ïÎ†•Ìïú Ïò§ÌîÑÎãù",
  "slides": [
    {
      "number": 1,
      "title": "Ïä¨ÎùºÏù¥Îìú Ï†úÎ™©",
      "content": "ÌïµÏã¨ Î©îÏãúÏßÄ",
      "visualKeywords": "Ïù¥ÎØ∏ÏßÄÏö© ÌÇ§ÏõåÎìú",
      "timing": "3-5Ï¥à"
    }
  ],
  "hashtags": ["Í¥ÄÎ†®", "Ìï¥ÏãúÌÉúÍ∑∏"],
  "thumbnail": "Ïç∏ÎÑ§Ïùº ÏÑ§Î™Ö"
}`,

                imagePrompt: `Professional image for slide about "{title}". 
Content: {content}
Style: {visualStyle}, clean, modern, {emotion}.
Elements: {visualKeywords}
Format: 9:16 vertical, mobile-optimized, high quality.`
            }
        };

        // ===== Î©îÏù∏ ÏûêÎèô ÏÉùÏÑ± Ìï®Ïàò =====
        async function startAutoGeneration() {
            if (!openaiApiKey) {
                showStatus('‚ùå Î®ºÏ†Ä OpenAI APIÎ•º Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî!', 'error', 'openaiStatus');
                return;
            }

            try {
                showProgressModal(true);
                updateProgress(5, 'üöÄ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† ÏÉùÏÑ± ÏãúÏûë', 'AIÍ∞Ä 100ÎßåÎ∑∞ Í≥µÏãùÏùÑ Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...', 'ü§ñ');

                let contentData;
                
                if (selectedGenerationMode === 'auto') {
                    contentData = await generateAutoContent();
                } else if (selectedGenerationMode === 'semi-auto') {
                    contentData = await generateSemiAutoContent();
                } else {
                    contentData = await generateManualContent();
                }

                updateProgress(60, 'üé® AI Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë', 'DALL-E 3Í∞Ä ÏôÑÎ≤ΩÌïú Ïù¥ÎØ∏ÏßÄÎì§ÏùÑ ÎßåÎì§Í≥† ÏûàÏäµÎãàÎã§...', 'üé®');
                await delay(1000);

                // Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
                const imagesData = await generateAllImages(contentData);
                
                updateProgress(85, 'üé¨ Ïä¨ÎùºÏù¥Îìú Î†åÎçîÎßÅ', 'ÏµúÏ¢Ö Ïä¨ÎùºÏù¥ÎìúÏáºÎ•º ÏôÑÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§...', '‚ú®');
                await delay(800);

                // Ïä¨ÎùºÏù¥Îìú ÏÉùÏÑ±
                generatedSlides = contentData.slides;
                generatedImages = imagesData;
                
                await createSlideshowWithImages(contentData, imagesData);
                
                updateProgress(100, 'üéâ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† ÏôÑÏÑ±!', '100ÎßåÎ∑∞ ÏΩòÌÖêÏ∏†Í∞Ä Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§!', 'üèÜ');
                await delay(1000);

                showProgressModal(false);
                showResults(contentData);
                showSuccessNotification('üéâ ÌôòÏÉÅÏ†ÅÏù∏ Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏†Í∞Ä ÏôÑÏÑ±ÎêòÏóàÏäµÎãàÎã§!');

            } catch (error) {
                console.error('ÏΩòÌÖêÏ∏† ÏÉùÏÑ± Ïò§Î•ò:', error);
                showProgressModal(false);
                
                let errorMessage = '‚ùå ÏΩòÌÖêÏ∏† ÏÉùÏÑ± Ïã§Ìå®: ';
                if (error.message.includes('429')) {
                    errorMessage += 'API ÏöîÏ≤≠ ÌïúÎèÑ Ï¥àÍ≥º. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.message.includes('token')) {
                    errorMessage += 'ÏûÖÎ†• ÎÇ¥Ïö©Ïù¥ ÎÑàÎ¨¥ ÍπÅÎãàÎã§. Îçî Í∞ÑÍ≤∞ÌïòÍ≤å ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.';
                } else {
                    errorMessage += error.message;
                }
                
                showStatus(errorMessage, 'error', 'openaiStatus');
            }
        }

        // ===== ÏôÑÏ†Ñ ÏûêÎèô Î™®Îìú ÏΩòÌÖêÏ∏† ÏÉùÏÑ± =====
        async function generateAutoContent() {
            const keyword = document.getElementById('viralKeyword').value.trim();
            const channelType = document.getElementById('channelType').value;
            const contentTone = document.getElementById('contentTone').value;
            const slideCount = document.getElementById('slideCount').value;

            updateProgress(15, 'üß† GPT-4 Î∞îÏù¥Îü¥ Î∂ÑÏÑù', `"${keyword}" ÌÇ§ÏõåÎìúÎ°ú 100ÎßåÎ∑∞ ÏΩòÌÖêÏ∏† ÏÑ§Í≥Ñ Ï§ë...`, 'üß†');
            
            const prompt = viralPromptTemplates.auto.contentAnalysis
                .replace('{keyword}', keyword)
                .replace('{channelType}', channelType)
                .replace('{contentTone}', contentTone)
                .replace('{slideCount}', slideCount);

            console.log('ü§ñ GPT-4 ÌîÑÎ°¨ÌîÑÌä∏:', prompt);

            const response = await callOpenAI(prompt, selectedGPTModel, 3000, 0.8);
            console.log('ü§ñ GPT-4 ÏùëÎãµ:', response);

            let contentData;
            try {
                // JSON Ï∂îÏ∂ú
                const jsonMatch = response.match(/\{[\s\S]*\}/);
                if (jsonMatch) {
                    contentData = JSON.parse(jsonMatch[0]);
                } else {
                    contentData = JSON.parse(response);
                }
                
                // Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è Î≥¥Ï†ï
                contentData = validateAndFixContentData(contentData, slideCount);
                
                updateProgress(35, '‚úÖ ÏΩòÌÖêÏ∏† Íµ¨Ï°∞ ÏôÑÏÑ±', `"${contentData.title}" - ${contentData.slides.length}Ïû• Ïä¨ÎùºÏù¥Îìú ÏÉùÏÑ±`, 'üìã');
                
                return contentData;
                
            } catch (parseError) {
                console.error('JSON ÌååÏã± Ïò§Î•ò:', parseError);
                console.log('ÏõêÎ≥∏ ÏùëÎãµ:', response);
                
                // ÌååÏã± Ïã§Ìå® Ïãú Î∞±ÏóÖ ÏÉùÏÑ±
                return generateBackupContent(keyword, slideCount);
            }
        }

        // ===== Î∞òÏûêÎèô Î™®Îìú ÏΩòÌÖêÏ∏† ÏÉùÏÑ± =====
        async function generateSemiAutoContent() {
            const title = document.getElementById('contentTitle').value.trim();
            const content = document.getElementById('contentDescription').value.trim();
            const slideCount = document.getElementById('slideCount').value;

            updateProgress(15, 'üìù ÏΩòÌÖêÏ∏† ÏµúÏ†ÅÌôî', `"${title}" ÏΩòÌÖêÏ∏†Î•º Î∞îÏù¥Îü¥ ÌòïÌÉúÎ°ú Î≥ÄÌôò Ï§ë...`, 'üìù');

            const prompt = viralPromptTemplates.semiAuto.contentAnalysis
                .replace('{title}', title)
                .replace('{content}', content)
                .replace('{slideCount}', slideCount);

            const response = await callOpenAI(prompt, selectedGPTModel, 3000, 0.7);
            
            try {
                const jsonMatch = response.match(/\{[\s\S]*\}/);
                const contentData = JSON.parse(jsonMatch ? jsonMatch[0] : response);
                
                updateProgress(35, '‚úÖ ÏµúÏ†ÅÌôî ÏôÑÎ£å', `${contentData.slides.length}Ïû• Íµ¨Ï°∞Î°ú Ïû¨Íµ¨ÏÑ± ÏôÑÎ£å`, '‚úÖ');
                
                return validateAndFixContentData(contentData, slideCount);
                
            } catch (error) {
                console.error('Î∞òÏûêÎèô Î™®Îìú ÌååÏã± Ïò§Î•ò:', error);
                return generateBackupContent(title, slideCount);
            }
        }

        // ===== ÏàòÎèô Î™®Îìú ÏΩòÌÖêÏ∏† ÏÉùÏÑ± =====
        async function generateManualContent() {
            const title = document.getElementById('manualTitle').value.trim();
            const content = document.getElementById('manualContent').value.trim();
            const slideCount = parseInt(document.getElementById('slideCount').value);

            updateProgress(15, 'üìã ÏàòÎèô ÏΩòÌÖêÏ∏† Íµ¨ÏÑ±', 'ÏûÖÎ†•ÌïòÏã† ÎÇ¥Ïö©ÏúºÎ°ú Ïä¨ÎùºÏù¥Îìú Íµ¨ÏÑ± Ï§ë...', 'üìã');

            // Í∞ÑÎã®Ìïú Ïä¨ÎùºÏù¥Îìú Î∂ÑÌï†
            const sentences = content.split(/[.!?]\s+/).filter(s => s.trim().length > 0);
            const slides = [];
            
            // Ï≤´ Ïä¨ÎùºÏù¥ÎìúÎäî Ï†úÎ™©
            slides.push({
                number: 1,
                title: title,
                content: "ÏãúÏûëÌïòÍ≤†ÏäµÎãàÎã§!",
                emotion: "Í∏∞ÎåÄÍ∞ê",
                visualKeywords: title.split(' ').slice(0, 3).join(' ')
            });

            // ÎÇòÎ®∏ÏßÄ Ïä¨ÎùºÏù¥Îìú Î∂ÑÎ∞∞
            const contentPerSlide = Math.ceil(sentences.length / (slideCount - 1));
            for (let i = 0; i < slideCount - 1; i++) {
                const startIdx = i * contentPerSlide;
                const endIdx = Math.min(startIdx + contentPerSlide, sentences.length);
                const slideContent = sentences.slice(startIdx, endIdx).join('. ');
                
                if (slideContent.trim()) {
                    slides.push({
                        number: slides.length + 1,
                        title: `Ìè¨Ïù∏Ìä∏ ${slides.length}`,
                        content: slideContent,
                        emotion: "ÏßëÏ§ë",
                        visualKeywords: extractKeywords(slideContent)
                    });
                }
            }

            updateProgress(35, '‚úÖ ÏàòÎèô Íµ¨ÏÑ± ÏôÑÎ£å', `${slides.length}Ïû• Ïä¨ÎùºÏù¥Îìú Ï§ÄÎπÑ ÏôÑÎ£å`, '‚úÖ');

            return {
                title: title,
                hook: title,
                slides: slides,
                viralScore: 75,
                hashtags: ["#ÏΩòÌÖêÏ∏†", "#Ïú†ÌäúÎ∏åÏáºÏ∏†"],
                thumbnail: `${title}Ïóê ÎåÄÌïú Ï†ÑÎ¨∏Ï†ÅÏù∏ Ïù¥ÎØ∏ÏßÄ`
            };
        }

        // ===== ÏΩòÌÖêÏ∏† Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è Î≥¥Ï†ï =====
        function validateAndFixContentData(data, targetSlideCount) {
            // Í∏∞Î≥∏ Íµ¨Ï°∞ ÌôïÏù∏
            if (!data.slides || !Array.isArray(data.slides)) {
                throw new Error('Ïä¨ÎùºÏù¥Îìú Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.');
            }

            // Ïä¨ÎùºÏù¥Îìú Í∞úÏàò Ï°∞Ï†ï
            const target = parseInt(targetSlideCount);
            if (data.slides.length < target) {
                // Î∂ÄÏ°±Ìïú Í≤ΩÏö∞ ÎßàÏßÄÎßâ Ïä¨ÎùºÏù¥Îìú Î≥µÏ†ú Î∞è Î≥ÄÌòï
                while (data.slides.length < target) {
                    const lastSlide = data.slides[data.slides.length - 1];
                    const newSlide = {
                        number: data.slides.length + 1,
                        title: `Ï∂îÍ∞Ä Ìè¨Ïù∏Ìä∏ ${data.slides.length + 1}`,
                        content: lastSlide.content + " Îçî ÏûêÏÑ∏Ìûà ÏïåÏïÑÎ≥¥ÏÑ∏Ïöî!",
                        emotion: lastSlide.emotion || "Í¥ÄÏã¨",
                        visualKeywords: lastSlide.visualKeywords || "Ï†ïÎ≥¥"
                    };
                    data.slides.push(newSlide);
                }
            } else if (data.slides.length > target) {
                // Ï¥àÍ≥ºÌïú Í≤ΩÏö∞ ÏûêÎ•¥Í∏∞
                data.slides = data.slides.slice(0, target);
            }

            // Ïä¨ÎùºÏù¥Îìú Î≤àÌò∏ Ïû¨Ï†ïÎ†¨
            data.slides.forEach((slide, index) => {
                slide.number = index + 1;
            });

            // ÎàÑÎùΩÎêú ÌïÑÎìú Î≥¥ÏôÑ
            data.title = data.title || data.optimizedTitle || 'Ìù•ÎØ∏Î°úÏö¥ ÏΩòÌÖêÏ∏†';
            data.hook = data.hook || data.title;
            data.viralScore = data.viralScore || 80;
            data.hashtags = data.hashtags || ['#Ïú†ÌäúÎ∏åÏáºÏ∏†', '#Î∞îÏù¥Îü¥'];
            data.thumbnail = data.thumbnail || `${data.title}Ïóê ÎåÄÌïú Îß§Î†•Ï†ÅÏù∏ Ïç∏ÎÑ§Ïùº`;

            return data;
        }

        // ===== Î∞±ÏóÖ ÏΩòÌÖêÏ∏† ÏÉùÏÑ± =====
        function generateBackupContent(keyword, slideCount) {
            const count = parseInt(slideCount);
            const slides = [];
            
            for (let i = 1; i <= count; i++) {
                slides.push({
                    number: i,
                    title: i === 1 ? keyword : `${keyword} - Ìè¨Ïù∏Ìä∏ ${i}`,
                    content: i === 1 ? 
                        `${keyword}Ïóê ÎåÄÌï¥ ÏïåÏïÑÎ≥¥Í≤†ÏäµÎãàÎã§!` : 
                        `${keyword}Ïùò Ï§ëÏöîÌïú ${i}Î≤àÏß∏ Ìè¨Ïù∏Ìä∏ÏûÖÎãàÎã§.`,
                    emotion: i === 1 ? "Í∏∞ÎåÄÍ∞ê" : "Í¥ÄÏã¨",
                    visualKeywords: keyword
                });
            }

            return {
                title: `${keyword} ÏôÑÏ†Ñ Ï†ïÎ≥µ`,
                hook: `${keyword}Ïùò ÎÜÄÎùºÏö¥ ÏßÑÏã§`,
                slides: slides,
                viralScore: 75,
                hashtags: [`#${keyword}`, '#Ïú†ÌäúÎ∏åÏáºÏ∏†'],
                thumbnail: `${keyword}Ïóê ÎåÄÌïú Ìù•ÎØ∏Î°úÏö¥ Ïù¥ÎØ∏ÏßÄ`
            };
        }

        // ===== AI Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏãúÏä§ÌÖú =====
        async function generateAllImages(contentData) {
            const images = [];
            const visualStyle = document.getElementById('visualStyle').value;
            const imageQuality = document.getElementById('imageQuality').value;
            const imageSize = document.getElementById('imageSize').value;
            const imageStyle = document.getElementById('imageStyle').value;

            // Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
            updateProgress(65, 'üé® Ïç∏ÎÑ§Ïùº ÏÉùÏÑ±', 'DALL-E 3Í∞Ä Îß§Î†•Ï†ÅÏù∏ Ïç∏ÎÑ§ÏùºÏùÑ ÎßåÎì§Í≥† ÏûàÏäµÎãàÎã§...', 'üñºÔ∏è');
            
            try {
                const thumbnailPrompt = viralPromptTemplates[selectedGenerationMode === 'auto' ? 'auto' : 'semiAuto'].imagePrompt
                    .replace('{title}', contentData.title)
                    .replace('{visualStyle}', visualStyle)
                    .replace('{emotion}', 'exciting')
                    .replace('{visualKeywords}', contentData.thumbnail);

                const thumbnailUrl = await generateImageWithDALLE(thumbnailPrompt, imageQuality, imageSize, imageStyle);
                
                if (thumbnailUrl) {
                    images.push({
                        type: 'thumbnail',
                        url: thumbnailUrl,
                        prompt: thumbnailPrompt,
                        title: 'Ïç∏ÎÑ§Ïùº'
                    });
                }
            } catch (error) {
                console.warn('Ïç∏ÎÑ§Ïùº ÏÉùÏÑ± Ïã§Ìå®:', error);
            }

            // Í∞Å Ïä¨ÎùºÏù¥ÎìúÎ≥Ñ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± (Ï≤òÏùå 5Í∞úÎßå)
            const maxImages = Math.min(5, contentData.slides.length);
            
            for (let i = 0; i < maxImages; i++) {
                const slide = contentData.slides[i];
                const progress = 65 + (i + 1) * (15 / maxImages);
                
                updateProgress(progress, 'üé® Ïä¨ÎùºÏù¥Îìú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±', `${i + 1}/${maxImages} - "${slide.title}" Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë...`, 'üé®');
                
                try {
                    const slidePrompt = `High-quality image for: "${slide.title}". 
Content theme: ${slide.content}. 
Style: ${visualStyle}, professional, clean, modern.
Visual elements: ${slide.visualKeywords || slide.title}.
Emotion: ${slide.emotion || 'professional'}.
Format: Vertical 9:16, mobile-optimized, vibrant colors.`;

                    const imageUrl = await generateImageWithDALLE(slidePrompt, imageQuality, imageSize, imageStyle);
                    
                    if (imageUrl) {
                        images.push({
                            type: 'slide',
                            slideNumber: slide.number,
                            url: imageUrl,
                            prompt: slidePrompt,
                            title: slide.title
                        });
                    }
                    
                    // API Î†àÏù¥Ìä∏ Î¶¨ÎØ∏Ìä∏ Î∞©ÏßÄ
                    await delay(1000);
                    
                } catch (error) {
                    console.warn(`Ïä¨ÎùºÏù¥Îìú ${slide.number} Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïã§Ìå®:`, error);
                    
                    // Ïã§Ìå® Ïãú Í∏∞Î≥∏ Ïù¥ÎØ∏ÏßÄ Ï†ïÎ≥¥ Ï∂îÍ∞Ä
                    images.push({
                        type: 'slide',
                        slideNumber: slide.number,
                        url: null,
                        error: error.message,
                        title: slide.title
                    });
                }
            }

            // ÎÇòÎ®∏ÏßÄ Ïä¨ÎùºÏù¥ÎìúÎäî Ï≤´ Î≤àÏß∏ Ïù¥ÎØ∏ÏßÄ Ïû¨ÏÇ¨Ïö©
            if (images.length > 1 && contentData.slides.length > maxImages) {
                const firstSlideImage = images.find(img => img.type === 'slide' && img.url);
                if (firstSlideImage) {
                    for (let i = maxImages; i < contentData.slides.length; i++) {
                        images.push({
                            type: 'slide',
                            slideNumber: i + 1,
                            url: firstSlideImage.url,
                            title: contentData.slides[i].title,
                            reused: true
                        });
                    }
                }
            }

            console.log('üé® Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏôÑÎ£å:', images);
            return images;
        }

        // ===== Ïä¨ÎùºÏù¥ÎìúÏáº ÏÉùÏÑ± ÏãúÏä§ÌÖú =====
        async function createSlideshowWithImages(contentData, imagesData) {
            const container = document.getElementById('slideshowContainer');
            if (!container) return;

            container.innerHTML = '';

            contentData.slides.forEach((slide, index) => {
                const slideElement = createSlideElement(slide, index, imagesData);
                container.appendChild(slideElement);
            });

            currentSlide = 0;
            showSlide(0);
            updateSlideCounter();
        }

        // ===== Í∞úÎ≥Ñ Ïä¨ÎùºÏù¥Îìú ÏöîÏÜå ÏÉùÏÑ± =====
        function createSlideElement(slide, index, imagesData) {
            const slideDiv = document.createElement('div');
            slideDiv.className = 'slide';
            
            // Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ Ï∞æÍ∏∞
            const slideImage = imagesData.find(img => 
                img.type === 'slide' && img.slideNumber === slide.number && img.url
            );
            
            if (slideImage && slideImage.url) {
                slideDiv.style.backgroundImage = `url('${slideImage.url}')`;
                slideDiv.style.backgroundSize = 'cover';
                slideDiv.style.backgroundPosition = 'center';
            } else {
                // Í∏∞Î≥∏ Í∑∏ÎùºÎîîÏñ∏Ìä∏ Î∞∞Í≤Ω
                const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'];
                const color1 = colors[index % colors.length];
                const color2 = colors[(index + 1) % colors.length];
                slideDiv.style.background = `linear-gradient(135deg, ${color1}, ${color2})`;
            }

            // Ïò§Î≤ÑÎ†àÏù¥ Ï∂îÍ∞Ä (ÌÖçÏä§Ìä∏ Í∞ÄÎèÖÏÑ± Ìñ•ÏÉÅ)
            const overlay = document.createElement('div');
            overlay.className = 'slide-overlay';
            slideDiv.appendChild(overlay);

            // Ïä¨ÎùºÏù¥Îìú ÏΩòÌÖêÏ∏†
            const slideContent = document.createElement('div');
            slideContent.className = 'slide-content';
            
            // ÏïÑÏù¥ÏΩò (Í∞êÏ†ï Í∏∞Î∞ò)
            const iconDiv = document.createElement('div');
            iconDiv.className = 'slide-icon';
            iconDiv.textContent = getEmotionIcon(slide.emotion) || 'üöÄ';
            
            // Ï†úÎ™©
            const titleDiv = document.createElement('div');
            titleDiv.className = 'slide-title';
            titleDiv.textContent = slide.title || '';
            
            // ÎÇ¥Ïö©
            const contentDiv = document.createElement('div');
            contentDiv.className = 'slide-subtitle';
            contentDiv.textContent = slide.content || '';
            
            slideContent.appendChild(iconDiv);
            slideContent.appendChild(titleDiv);
            slideContent.appendChild(contentDiv);
            slideDiv.appendChild(slideContent);
            
            return slideDiv;
        }

        // ===== Í∞êÏ†ï ÏïÑÏù¥ÏΩò Îß§Ìïë =====
        function getEmotionIcon(emotion) {
            const iconMap = {
                'Í∏∞ÎåÄÍ∞ê': 'üöÄ', 'ÎÜÄÎùºÏõÄ': 'üò±', 'Ìò∏Í∏∞Ïã¨': 'ü§î', 'Ïû¨ÎØ∏': 'üòÑ',
                'Í¥ÄÏã¨': 'üëÄ', 'ÏßëÏ§ë': 'üéØ', 'ÏÑ±Ï∑®Í∞ê': 'üèÜ', 'ÎèôÍ∏∞Î∂ÄÏó¨': 'üí™',
                'Ìù¨Îßù': '‚≠ê', 'ÏõÉÏùå': 'üòÇ', 'Í≥µÍ∞ê': '‚ù§Ô∏è', 'ÌïôÏäµÏöïÍµ¨': 'üìö',
                'exciting': 'üî•', 'professional': 'üíº', 'inspiring': '‚ú®'
            };
            return iconMap[emotion] || 'üí´';
        }

        // ===== ÌÇ§ÏõåÎìú Ï∂îÏ∂ú Ìï®Ïàò =====
        function extractKeywords(text) {
            const words = text.split(/\s+/).filter(word => word.length > 2);
            return words.slice(0, 3).join(' ');
        }

        // ===== Ïä¨ÎùºÏù¥Îìú ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏãúÏä§ÌÖú =====
        function showSlide(index) {
            const slides = document.querySelectorAll('.slide');
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            
            currentSlide = index;
            updateSlideCounter();
        }

        function updateSlideCounter() {
            const counter = document.getElementById('slideCounter');
            if (counter && generatedSlides.length > 0) {
                counter.textContent = `${currentSlide + 1} / ${generatedSlides.length}`;
            }
        }

        function prevSlide() {
            if (generatedSlides.length === 0) return;
            const newIndex = currentSlide > 0 ? currentSlide - 1 : generatedSlides.length - 1;
            showSlide(newIndex);
            if (isAutoPlaying) toggleAutoPlay();
        }

        function nextSlide() {
            if (generatedSlides.length === 0) return;
            const newIndex = currentSlide < generatedSlides.length - 1 ? currentSlide + 1 : 0;
            showSlide(newIndex);
            if (isAutoPlaying) toggleAutoPlay();
        }

        function toggleAutoPlay() {
            const autoPlayBtn = document.getElementById('autoPlayBtn');
            
            if (isAutoPlaying) {
                clearInterval(autoPlayInterval);
                isAutoPlaying = false;
                if (autoPlayBtn) autoPlayBtn.textContent = '‚ñ∂Ô∏è ÏûêÎèôÏû¨ÏÉù';
            } else {
                autoPlayInterval = setInterval(() => {
                    const nextIndex = currentSlide < generatedSlides.length - 1 ? currentSlide + 1 : 0;
                    showSlide(nextIndex);
                }, 3000);
                isAutoPlaying = true;
                if (autoPlayBtn) autoPlayBtn.textContent = '‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ';
            }
        }

        // ===== Í≤∞Í≥º ÌëúÏãú ÏãúÏä§ÌÖú =====
        function showResults(contentData) {
            const resultSection = document.getElementById('resultSection');
            if (resultSection) {
                resultSection.classList.remove('hidden');
                resultSection.scrollIntoView({ behavior: 'smooth' });
            }

            // ÏΩòÌÖêÏ∏† ÌÉ≠ ÏóÖÎç∞Ïù¥Ìä∏
            updateContentTab(contentData);
            
            // Ïù¥ÎØ∏ÏßÄ Í∞§Îü¨Î¶¨ ÏóÖÎç∞Ïù¥Ìä∏
            updateImageGallery();
            
            // Î∂ÑÏÑù ÌÉ≠ ÏóÖÎç∞Ïù¥Ìä∏
            updateAnalyticsTab(contentData);
        }

        // ===== ÌÉ≠ ÏãúÏä§ÌÖú =====
        function showTab(tabName) {
            // Î™®Îì† ÌÉ≠ ÎπÑÌôúÏÑ±Ìôî
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠ ÌôúÏÑ±Ìôî
            const tabBtn = document.querySelector(`.tab-btn[onclick="showTab('${tabName}')"]`);
            const tabContent = document.getElementById(tabName + 'Tab');
            
            if (tabBtn) tabBtn.classList.add('active');
            if (tabContent) tabContent.classList.add('active');
        }

        function updateContentTab(contentData) {
            const contentElement = document.getElementById('generatedContent');
            if (!contentElement) return;

            contentElement.innerHTML = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">üìù Ï†úÎ™©</h3>
                    <div style="font-size: 1.4em; font-weight: bold; margin-bottom: 20px;">${contentData.title}</div>
                    
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">üéØ Í∞ïÎ†•Ìïú ÌõÖ</h3>
                    <div style="font-size: 1.2em; margin-bottom: 20px; color: #feca57;">"${contentData.hook}"</div>
                    
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">üèÜ Î∞îÏù¥Îü¥ Ï†êÏàò</h3>
                    <div style="font-size: 1.3em; font-weight: bold; color: ${contentData.viralScore > 80 ? '#43e97b' : contentData.viralScore > 60 ? '#feca57' : '#ff6b6b'};">
                        ${contentData.viralScore}/100 Ï†ê
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">üìã Ïä¨ÎùºÏù¥Îìú Íµ¨ÏÑ±</h3>
                    ${contentData.slides.map(slide => `
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 4px solid #4ecdc4;">
                            <h4 style="color: #4ecdc4; margin-bottom: 10px;">${slide.number}. ${slide.title}</h4>
                            <p style="line-height: 1.6;">${slide.content}</p>
                            <div style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                                Í∞êÏ†ï: ${getEmotionIcon(slide.emotion)} ${slide.emotion} | ÌÇ§ÏõåÎìú: ${slide.visualKeywords || 'N/A'}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div>
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">#Ô∏è‚É£ Ï∂îÏ≤ú Ìï¥ÏãúÌÉúÍ∑∏</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        ${contentData.hashtags.map(tag => `
                            <span style="background: linear-gradient(45deg, #667eea, #764ba2); padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                                ${tag}
                            </span>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function updateImageGallery() {
            const gallery = document.getElementById('imageGallery');
            if (!gallery) return;

            gallery.innerHTML = '';

            if (generatedImages.length === 0) {
                gallery.innerHTML = '<p style="text-align: center; opacity: 0.7;">Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏÉùÏÑ±ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.</p>';
                return;
            }

            generatedImages.forEach((image, index) => {
                if (image.url) {
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    galleryItem.innerHTML = `
                        <img src="${image.url}" alt="${image.title}" loading="lazy">
                        <div class="gallery-overlay">
                            ${image.type === 'thumbnail' ? 'üì∑ Ïç∏ÎÑ§Ïùº' : `üìÑ Ïä¨ÎùºÏù¥Îìú ${image.slideNumber}`}
                            <br>${image.title}
                            ${image.reused ? '<br>üîÑ Ïû¨ÏÇ¨Ïö©Îê®' : ''}
                        </div>
                    `;
                    
                    galleryItem.addEventListener('click', () => {
                        showImageModal(image);
                    });
                    
                    gallery.appendChild(galleryItem);
                }
            });
        }

        function updateAnalyticsTab(contentData) {
            const analytics = document.getElementById('contentAnalytics');
            if (!analytics) return;

            // Î∞îÏù¥Îü¥ Î∂ÑÏÑù ÏàòÌñâ
            const channelType = document.getElementById('channelType')?.value || 'educational';
            const analysis = analyzeViralPotential(contentData.title + ' ' + contentData.slides.map(s => s.content).join(' '), channelType);

            analytics.innerHTML = `
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center;">
                    <h4 style="color: #4ecdc4; margin-bottom: 15px;">üèÜ Î∞îÏù¥Îü¥ Ï†êÏàò</h4>
                    <div style="font-size: 3em; font-weight: bold; color: ${contentData.viralScore > 80 ? '#43e97b' : contentData.viralScore > 60 ? '#feca57' : '#ff6b6b'};">
                        ${contentData.viralScore}/100
                    </div>
                    <div style="margin-top: 10px; font-size: 1.2em;">
                        ${analysis.rating}
                    </div>
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center;">
                    <h4 style="color: #4ecdc4; margin-bottom: 15px;">üìä ÏòàÏÉÅ ÏÑ±Í≥º</h4>
                    <div style="font-size: 1.4em; font-weight: bold; color: #43e97b;">
                        ${Math.floor(contentData.viralScore * 10000).toLocaleString()}+
                    </div>
                    <div style="margin-top: 5px;">ÏòàÏÉÅ Ï°∞ÌöåÏàò</div>
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center;">
                    <h4 style="color: #4ecdc4; margin-bottom: 15px;">‚è±Ô∏è ÏµúÏ†Å Í∏∏Ïù¥</h4>
                    <div style="font-size: 1.4em; font-weight: bold; color: #4ecdc4;">
                        ${contentData.slides.length * 3} Ï¥à
                    </div>
                    <div style="margin-top: 5px;">Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏôÑÎ≤Ω ÏµúÏ†ÅÌôî</div>
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center;">
                    <h4 style="color: #4ecdc4; margin-bottom: 15px;">üéØ ÌÉÄÍ≤ü Î∂ÑÏÑù</h4>
                    <div style="line-height: 1.6;">
                        <strong>ÌõÖ Í∞ïÎèÑ:</strong> ${analysis.analysis.hooks}%<br>
                        <strong>Í∞êÏ†ï Ïó∞Í≤∞:</strong> ${analysis.analysis.emotions}%<br>
                        <strong>ÌÇ§ÏõåÎìú ÏµúÏ†ÅÌôî:</strong> ${analysis.analysis.keywords}%
                    </div>
                </div>
            `;
        }

        // ===== 3Îã®Í≥Ñ: ÌôòÏÉÅÏ†ÅÏù∏ ÏôÑÎ≤Ω ÏòÅÏÉÅ ÎÖπÌôî ÏãúÏä§ÌÖú =====
        
        // Í≥†Í∏â ÎÖπÌôî ÏÑ§Ï†ï
        const recordingConfig = {
            canvas: {
                width: 1080,
                height: 1920,
                fps: 30,
                bitrate: 8000000
            },
            video: {
                format: 'webm',
                codec: 'vp9',
                quality: 'high'
            },
            audio: {
                enabled: true,
                bitrate: 128000,
                sampleRate: 44100
            },
            timing: {
                totalDuration: 45000, // 45Ï¥à
                slideTransition: 800,  // 0.8Ï¥à Ï†ÑÌôò
                fadeEffect: 400       // 0.4Ï¥à ÌéòÏù¥Îìú
            }
        };

        // ÎÖπÌôî ÏÉÅÌÉú Í¥ÄÎ¶¨
        let recordingState = {
            isRecording: false,
            mediaRecorder: null,
            recordedChunks: [],
            canvas: null,
            ctx: null,
            currentFrame: 0,
            startTime: 0,
            audioContext: null,
            audioStream: null,
            videoStream: null
        };

        // ÏùåÏÑ± Ìï©ÏÑ± ÏãúÏä§ÌÖú
        let speechSystem = {
            voices: [],
            selectedVoice: null,
            isEnabled: false,
            rate: 1.0,
            pitch: 1.0,
            volume: 0.8
        };

        // Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏä§ÌÖú
        let musicSystem = {
            audioContext: null,
            musicBuffer: null,
            gainNode: null,
            isPlaying: false,
            volume: 0.3
        };

        // ===== Í≥†Í∏â ÏòÅÏÉÅ ÎÖπÌôî Ï¥àÍ∏∞Ìôî =====
        async function initializeAdvancedRecording() {
            try {
                console.log('üé¨ Í≥†Í∏â ÏòÅÏÉÅ ÎÖπÌôî ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏãúÏûë');
                
                // Canvas ÏÉùÏÑ±
                recordingState.canvas = document.createElement('canvas');
                recordingState.canvas.width = recordingConfig.canvas.width;
                recordingState.canvas.height = recordingConfig.canvas.height;
                recordingState.ctx = recordingState.canvas.getContext('2d');
                
                // Í≥†ÌíàÏßà Î†åÎçîÎßÅ ÏÑ§Ï†ï
                recordingState.ctx.imageSmoothingEnabled = true;
                recordingState.ctx.imageSmoothingQuality = 'high';
                recordingState.ctx.textRenderingOptimization = 'optimizeQuality';
                
                // ÎπÑÎîîÏò§ Ïä§Ìä∏Î¶º ÏÉùÏÑ±
                recordingState.videoStream = recordingState.canvas.captureStream(recordingConfig.canvas.fps);
                
                // Ïò§ÎîîÏò§ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
                await initializeAudioSystem();
                
                // ÏùåÏÑ± Ìï©ÏÑ± Ï¥àÍ∏∞Ìôî
                initializeSpeechSynthesis();
                
                // Î∞∞Í≤ΩÏùåÏïÖ Ï¥àÍ∏∞Ìôî
                await initializeBackgroundMusic();
                
                console.log('‚úÖ Í≥†Í∏â ÏòÅÏÉÅ ÎÖπÌôî ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                return true;
                
            } catch (error) {
                console.error('‚ùå ÎÖπÌôî ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                throw error;
            }
        }

        // ===== Ïò§ÎîîÏò§ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî =====
        async function initializeAudioSystem() {
            try {
                // Web Audio API Ï¥àÍ∏∞Ìôî
                recordingState.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // ÎßàÏù¥ÌÅ¨ Í∂åÌïú ÏöîÏ≤≠ (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                try {
                    recordingState.audioStream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            autoGainControl: true,
                            sampleRate: recordingConfig.audio.sampleRate
                        } 
                    });
                    console.log('üé§ ÎßàÏù¥ÌÅ¨ Ïò§ÎîîÏò§ ÏÇ¨Ïö© Í∞ÄÎä•');
                } catch (micError) {
                    console.warn('‚ö†Ô∏è ÎßàÏù¥ÌÅ¨ Ï†ëÍ∑º Î∂àÍ∞Ä (ÏÑ†ÌÉùÏÇ¨Ìï≠):', micError);
                }
                
                return true;
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Ïò§ÎîîÏò§ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                return false;
            }
        }

        // ===== ÏùåÏÑ± Ìï©ÏÑ± ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî =====
        function initializeSpeechSynthesis() {
            if (!('speechSynthesis' in window)) {
                console.warn('‚ö†Ô∏è ÏùåÏÑ± Ìï©ÏÑ± ÏßÄÏõêÌïòÏßÄ ÏïäÏùå');
                return;
            }
            
            // ÏùåÏÑ± Î™©Î°ù Î°úÎìú
            speechSystem.voices = speechSynthesis.getVoices();
            
            // ÌïúÍµ≠Ïñ¥ ÏùåÏÑ± Ï∞æÍ∏∞
            speechSystem.selectedVoice = speechSystem.voices.find(voice => 
                voice.lang.includes('ko') || voice.name.includes('Korean')
            ) || speechSystem.voices[0];
            
            speechSynthesis.onvoiceschanged = () => {
                speechSystem.voices = speechSynthesis.getVoices();
                speechSystem.selectedVoice = speechSystem.voices.find(voice => 
                    voice.lang.includes('ko') || voice.name.includes('Korean')
                ) || speechSystem.voices[0];
            };
            
            console.log('üó£Ô∏è ÏùåÏÑ± Ìï©ÏÑ± ÏãúÏä§ÌÖú Ï§ÄÎπÑÎê®:', speechSystem.selectedVoice?.name);
        }

        // ===== Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî =====
        async function initializeBackgroundMusic() {
            if (!recordingState.audioContext) return;
            
            try {
                // Web Audio APIÎ°ú ÏùåÏïÖ ÏÉùÏÑ±
                musicSystem.audioContext = recordingState.audioContext;
                musicSystem.gainNode = musicSystem.audioContext.createGain();
                musicSystem.gainNode.connect(musicSystem.audioContext.destination);
                musicSystem.gainNode.gain.value = musicSystem.volume;
                
                console.log('üéµ Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏä§ÌÖú Ï§ÄÎπÑÎê®');
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Î∞∞Í≤ΩÏùåÏïÖ Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
            }
        }

        // ===== Î©îÏù∏ ÎÖπÌôî ÏãúÏûë Ìï®Ïàò =====
        async function startRecording() {
            if (generatedSlides.length === 0) {
                showStatus('‚ùå Î®ºÏ†Ä ÏΩòÌÖêÏ∏†Î•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî!', 'error', 'openaiStatus');
                return;
            }

            try {
                showRecordingUI(true);
                updateRecordingProgress(0, 'üé¨ Í≥†Í∏â ÏòÅÏÉÅ ÎÖπÌôî Ï§ÄÎπÑ Ï§ë...', 'Canvas Î†åÎçîÎßÅ ÏóîÏßÑ Ï¥àÍ∏∞Ìôî Ï§ë...');

                // Í≥†Í∏â ÎÖπÌôî ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
                await initializeAdvancedRecording();
                
                updateRecordingProgress(15, 'üé® Î†åÎçîÎßÅ ÏóîÏßÑ Ï§ÄÎπÑ ÏôÑÎ£å', 'ÏôÑÎ≤ΩÌïú 45Ï¥à ÏòÅÏÉÅÏùÑ ÏúÑÌïú ÏÑ§Ï†ï Ï§ë...');
                await delay(500);

                // MediaRecorder ÏÑ§Ï†ï
                await setupMediaRecorder();
                
                updateRecordingProgress(25, 'üéµ Ïò§ÎîîÏò§ ÏãúÏä§ÌÖú ÎèôÍ∏∞Ìôî', 'ÏùåÏÑ± Ìï©ÏÑ±Í≥º Î∞∞Í≤ΩÏùåÏïÖ Ï§ÄÎπÑ Ï§ë...');
                await delay(500);

                // Ïã§Ï†ú ÎÖπÌôî ÏãúÏûë
                await startAdvancedRecording();
                
            } catch (error) {
                console.error('ÎÖπÌôî ÏãúÏûë Ïò§Î•ò:', error);
                showRecordingUI(false);
                showStatus('‚ùå ÎÖπÌôî ÏãúÏûë Ïã§Ìå®: ' + error.message, 'error', 'openaiStatus');
            }
        }

        // ===== MediaRecorder ÏÑ§Ï†ï =====
        async function setupMediaRecorder() {
            const streams = [recordingState.videoStream];
            
            // Ïò§ÎîîÏò§ Ïä§Ìä∏Î¶ºÏù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
            if (recordingState.audioStream) {
                streams.push(recordingState.audioStream);
            }
            
            // Î™®Îì† Ïä§Ìä∏Î¶º Í≤∞Ìï©
            const combinedStream = new MediaStream();
            streams.forEach(stream => {
                stream.getTracks().forEach(track => {
                    combinedStream.addTrack(track);
                });
            });
            
            // MediaRecorder ÏòµÏÖò
            const options = {
                mimeType: 'video/webm;codecs=vp9,opus',
                videoBitsPerSecond: recordingConfig.canvas.bitrate,
                audioBitsPerSecond: recordingConfig.audio.bitrate
            };
            
            // Ìò∏ÌôòÏÑ± ÌôïÏù∏
            if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                options.mimeType = 'video/webm;codecs=vp8,opus';
                if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                    options.mimeType = 'video/webm';
                }
            }
            
            recordingState.mediaRecorder = new MediaRecorder(combinedStream, options);
            recordingState.recordedChunks = [];
            
            recordingState.mediaRecorder.ondataavailable = (event) => {
                if (event.data && event.data.size > 0) {
                    recordingState.recordedChunks.push(event.data);
                }
            };
            
            recordingState.mediaRecorder.onstop = async () => {
                await finalizeRecording();
            };
            
            recordingState.mediaRecorder.onerror = (event) => {
                console.error('MediaRecorder Ïò§Î•ò:', event.error);
                showStatus('‚ùå ÎÖπÌôî Ï§ë Ïò§Î•ò Î∞úÏÉù', 'error', 'openaiStatus');
            };
        }

        // ===== Í≥†Í∏â ÎÖπÌôî Ïã§Ìñâ =====
        async function startAdvancedRecording() {
            recordingState.isRecording = true;
            recordingState.startTime = Date.now();
            recordingState.currentFrame = 0;
            
            // MediaRecorder ÏãúÏûë
            recordingState.mediaRecorder.start(100);
            
            updateRecordingProgress(30, 'üöÄ Í≥†ÌíàÏßà ÏòÅÏÉÅ ÎÖπÌôî ÏãúÏûë!', '45Ï¥à ÏôÑÎ≤Ω ÏòÅÏÉÅ ÏÉùÏÑ± Ï§ë...');
            
            // Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏûë
            if (musicSystem.audioContext && document.getElementById('backgroundMusic').value !== 'none') {
                await startBackgroundMusic();
            }
            
            // Ïä¨ÎùºÏù¥ÎìúÎ≥Ñ ÎÖπÌôî Ïã§Ìñâ
            await recordAllSlidesWithTiming();
        }

        // ===== ÌÉÄÏù¥Î∞ç Í∏∞Î∞ò Ïä¨ÎùºÏù¥Îìú ÎÖπÌôî =====
        async function recordAllSlidesWithTiming() {
            const totalDuration = recordingConfig.timing.totalDuration;
            const slideCount = generatedSlides.length;
            const slideDisplayTime = (totalDuration - (slideCount * recordingConfig.timing.slideTransition)) / slideCount;
            
            console.log(`üé¨ ${slideCount}Í∞ú Ïä¨ÎùºÏù¥Îìú, Í∞Å ${slideDisplayTime/1000}Ï¥à ÌëúÏãú`);
            
            for (let i = 0; i < slideCount && recordingState.isRecording; i++) {
                const progress = 30 + ((i + 1) / slideCount) * 60;
                updateRecordingProgress(progress, `üé® Ïä¨ÎùºÏù¥Îìú ${i + 1}/${slideCount} Î†åÎçîÎßÅ`, `"${generatedSlides[i].title}" Í≥†ÌíàÏßà Î†åÎçîÎßÅ Ï§ë...`);
                
                // Ïä¨ÎùºÏù¥Îìú Î†åÎçîÎßÅ ÏãúÏûë
                const slideStartTime = Date.now();
                
                // ÌéòÏù¥Îìú Ïù∏ Ìö®Í≥º
                await renderSlideWithTransition(i, 'fadeIn');
                
                // Ïä¨ÎùºÏù¥Îìú ÌëúÏãú ÏãúÍ∞Ñ ÎèôÏïà ÏßÄÏÜç Î†åÎçîÎßÅ
                while (Date.now() - slideStartTime < slideDisplayTime && recordingState.isRecording) {
                    await renderCurrentSlide(i);
                    await delay(33); // 30fps
                }
                
                // ÌéòÏù¥Îìú ÏïÑÏõÉ Ìö®Í≥º (ÎßàÏßÄÎßâ Ïä¨ÎùºÏù¥Îìú Ï†úÏô∏)
                if (i < slideCount - 1) {
                    await renderSlideWithTransition(i, 'fadeOut');
                }
                
                // ÏùåÏÑ± Ìï©ÏÑ± (ÏòµÏÖò)
                if (speechSystem.isEnabled && speechSystem.selectedVoice) {
                    speakSlideContent(generatedSlides[i]);
                }
            }
            
            // ÎÖπÌôî ÏôÑÎ£å
            if (recordingState.isRecording) {
                updateRecordingProgress(95, 'üèÅ ÏòÅÏÉÅ ÎßàÎ¨¥Î¶¨ Ï§ë...', 'ÏµúÏ¢Ö ÌîÑÎ†àÏûÑ Î†åÎçîÎßÅ Î∞è Ïù∏ÏΩîÎî© Ï§ë...');
                await delay(1000);
                
                recordingState.mediaRecorder.stop();
                recordingState.isRecording = false;
            }
        }

        // ===== Í≥†ÌíàÏßà Ïä¨ÎùºÏù¥Îìú Î†åÎçîÎßÅ =====
        async function renderCurrentSlide(slideIndex) {
            if (!recordingState.ctx || !generatedSlides[slideIndex]) return;
            
            const slide = generatedSlides[slideIndex];
            const canvas = recordingState.canvas;
            const ctx = recordingState.ctx;
            
            // Canvas ÌÅ¥Î¶¨Ïñ¥
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Î∞∞Í≤Ω Î†åÎçîÎßÅ
            await renderSlideBackground(ctx, slide, slideIndex);
            
            // ÌÖçÏä§Ìä∏ Î†åÎçîÎßÅ
            renderSlideText(ctx, slide, canvas.width, canvas.height);
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
            renderSlideAnimations(ctx, slideIndex);
            
            recordingState.currentFrame++;
        }

        // ===== Î∞∞Í≤Ω Î†åÎçîÎßÅ ÏãúÏä§ÌÖú =====
        async function renderSlideBackground(ctx, slide, slideIndex) {
            const canvas = recordingState.canvas;
            
            // AI ÏÉùÏÑ± Ïù¥ÎØ∏ÏßÄ Ï∞æÍ∏∞
            const slideImage = generatedImages.find(img => 
                img.type === 'slide' && img.slideNumber === slide.number && img.url
            );
            
            if (slideImage && slideImage.url) {
                try {
                    // Ïù¥ÎØ∏ÏßÄ Î°úÎìú Î∞è Í∑∏Î¶¨Í∏∞
                    const img = await loadImage(slideImage.url);
                    
                    // Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞ Ï°∞Ï†ï (9:16 ÎπÑÏú® ÎßûÏ∂§)
                    const scale = Math.max(canvas.width / img.width, canvas.height / img.height);
                    const scaledWidth = img.width * scale;
                    const scaledHeight = img.height * scale;
                    const x = (canvas.width - scaledWidth) / 2;
                    const y = (canvas.height - scaledHeight) / 2;
                    
                    ctx.drawImage(img, x, y, scaledWidth, scaledHeight);
                    
                    // ÌÖçÏä§Ìä∏ Í∞ÄÎèÖÏÑ±ÏùÑ ÏúÑÌïú Ïò§Î≤ÑÎ†àÏù¥
                    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                    gradient.addColorStop(0, 'rgba(0,0,0,0.4)');
                    gradient.addColorStop(0.5, 'rgba(0,0,0,0.2)');
                    gradient.addColorStop(1, 'rgba(0,0,0,0.6)');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                } catch (imageError) {
                    console.warn('Ïù¥ÎØ∏ÏßÄ Î°úÎî© Ïã§Ìå®, Í∑∏ÎùºÎîîÏñ∏Ìä∏ Î∞∞Í≤Ω ÏÇ¨Ïö©:', imageError);
                    renderGradientBackground(ctx, slideIndex);
                }
            } else {
                renderGradientBackground(ctx, slideIndex);
            }
        }

        function renderGradientBackground(ctx, slideIndex) {
            const canvas = recordingState.canvas;
            const colors = [
                ['#667eea', '#764ba2'],
                ['#f093fb', '#f5576c'], 
                ['#4facfe', '#00f2fe'],
                ['#43e97b', '#38f9d7'],
                ['#feca57', '#ff9ff3'],
                ['#ff6b6b', '#ee5a24']
            ];
            
            const colorPair = colors[slideIndex % colors.length];
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, colorPair[0]);
            gradient.addColorStop(1, colorPair[1]);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // ===== ÌÖçÏä§Ìä∏ Î†åÎçîÎßÅ ÏãúÏä§ÌÖú =====
        function renderSlideText(ctx, slide, canvasWidth, canvasHeight) {
            // ÌÖçÏä§Ìä∏ Í∑∏Î¶ºÏûê ÏÑ§Ï†ï
            ctx.shadowColor = 'rgba(0,0,0,0.8)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetX = 4;
            ctx.shadowOffsetY = 4;
            
            // ÏïÑÏù¥ÏΩò Î†åÎçîÎßÅ
            const iconSize = canvasHeight * 0.12;
            ctx.font = `bold ${iconSize}px Arial`;
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            const icon = getEmotionIcon(slide.emotion) || 'üöÄ';
            ctx.fillText(icon, canvasWidth / 2, canvasHeight * 0.25);
            
            // Ï†úÎ™© Î†åÎçîÎßÅ
            const titleSize = canvasHeight * 0.07;
            ctx.font = `900 ${titleSize}px Arial`;
            ctx.fillStyle = 'white';
            
            const title = slide.title || '';
            const titleLines = wrapText(ctx, title, canvasWidth * 0.9);
            const titleStartY = canvasHeight * 0.45;
            
            titleLines.forEach((line, index) => {
                ctx.fillText(line, canvasWidth / 2, titleStartY + (index * titleSize * 1.2));
            });
            
            // ÎÇ¥Ïö© Î†åÎçîÎßÅ
            if (slide.content && slide.content.trim()) {
                const contentSize = canvasHeight * 0.045;
                ctx.font = `600 ${contentSize}px Arial`;
                ctx.fillStyle = 'rgba(255,255,255,0.95)';
                
                const content = slide.content;
                const contentLines = wrapText(ctx, content, canvasWidth * 0.85);
                const contentStartY = canvasHeight * 0.7;
                
                contentLines.forEach((line, index) => {
                    ctx.fillText(line, canvasWidth / 2, contentStartY + (index * contentSize * 1.4));
                });
            }
            
            // Í∑∏Î¶ºÏûê Ï¥àÍ∏∞Ìôî
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
        }

        // ===== Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º ÏãúÏä§ÌÖú =====
        function renderSlideAnimations(ctx, slideIndex) {
            const animationStyle = document.getElementById('animationStyle').value;
            const time = (Date.now() - recordingState.startTime) / 1000;
            
            if (animationStyle === 'dynamic') {
                renderParticleEffects(ctx, time);
            } else if (animationStyle === 'smooth') {
                renderSmoothEffects(ctx, time);
            }
            // 'minimal'ÏùÄ Í∏∞Î≥∏ Î†åÎçîÎßÅÎßå ÏÇ¨Ïö©
        }

        function renderParticleEffects(ctx, time) {
            const canvas = recordingState.canvas;
            
            for (let i = 0; i < 20; i++) {
                const x = (Math.sin(time * 0.5 + i * 0.3) * 0.4 + 0.5) * canvas.width;
                const y = (Math.cos(time * 0.7 + i * 0.5) * 0.4 + 0.5) * canvas.height;
                const size = Math.sin(time * 2 + i) * 8 + 12;
                const opacity = Math.sin(time * 1.5 + i) * 0.4 + 0.6;
                
                ctx.globalAlpha = opacity;
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
            
            ctx.globalAlpha = 1;
        }

        function renderSmoothEffects(ctx, time) {
            const canvas = recordingState.canvas;
            
            // Î∂ÄÎìúÎü¨Ïö¥ Í∑∏ÎùºÎîîÏñ∏Ìä∏ Ïò§Î≤ÑÎ†àÏù¥
            const gradient = ctx.createRadialGradient(
                canvas.width / 2, canvas.height / 2, 0,
                canvas.width / 2, canvas.height / 2, canvas.width / 2
            );
            
            const hue = (time * 20) % 360;
            gradient.addColorStop(0, `hsla(${hue}, 50%, 80%, 0.1)`);
            gradient.addColorStop(1, `hsla(${(hue + 60) % 360}, 50%, 60%, 0.05)`);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // ===== Ï†ÑÌôò Ìö®Í≥º ÏãúÏä§ÌÖú =====
        async function renderSlideWithTransition(slideIndex, transitionType) {
            const transitionDuration = recordingConfig.timing.fadeEffect;
            const startTime = Date.now();
            
            while (Date.now() - startTime < transitionDuration) {
                const progress = (Date.now() - startTime) / transitionDuration;
                const alpha = transitionType === 'fadeIn' ? progress : 1 - progress;
                
                await renderCurrentSlide(slideIndex);
                
                // Ï†ÑÌôò Ìö®Í≥º Ï†ÅÏö©
                recordingState.ctx.globalCompositeOperation = 'source-over';
                recordingState.ctx.fillStyle = `rgba(0,0,0,${1 - alpha})`;
                recordingState.ctx.fillRect(0, 0, recordingState.canvas.width, recordingState.canvas.height);
                recordingState.ctx.globalCompositeOperation = 'source-over';
                
                await delay(16); // 60fps
            }
        }

        // ===== Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏä§ÌÖú =====
        async function startBackgroundMusic() {
            if (!musicSystem.audioContext) return;
            
            const musicType = document.getElementById('backgroundMusic').value;
            if (musicType === 'none') return;
            
            try {
                // Í∞ÑÎã®Ìïú Î∞∞Í≤ΩÏùåÏïÖ ÏÉùÏÑ± (Web Audio API)
                const oscillator = musicSystem.audioContext.createOscillator();
                const gainNode = musicSystem.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(musicSystem.audioContext.destination);
                
                // ÏùåÏïÖ Ïä§ÌÉÄÏùºÎ≥Ñ ÏÑ§Ï†ï
                const musicSettings = {
                    upbeat: { frequency: 440, type: 'square', volume: 0.1 },
                    ambient: { frequency: 220, type: 'sine', volume: 0.05 },
                    corporate: { frequency: 330, type: 'triangle', volume: 0.08 }
                };
                
                const setting = musicSettings[musicType] || musicSettings.upbeat;
                oscillator.frequency.setValueAtTime(setting.frequency, musicSystem.audioContext.currentTime);
                oscillator.type = setting.type;
                gainNode.gain.setValueAtTime(setting.volume, musicSystem.audioContext.currentTime);
                
                oscillator.start();
                
                // 45Ï¥à ÌõÑ Ï†ïÏßÄ
                setTimeout(() => {
                    oscillator.stop();
                }, recordingConfig.timing.totalDuration);
                
                musicSystem.isPlaying = true;
                console.log('üéµ Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏûë:', musicType);
                
            } catch (error) {
                console.warn('üéµ Î∞∞Í≤ΩÏùåÏïÖ ÏãúÏûë Ïã§Ìå®:', error);
            }
        }

        // ===== ÏùåÏÑ± Ìï©ÏÑ± ÏãúÏä§ÌÖú =====
        function speakSlideContent(slide) {
            if (!speechSystem.isEnabled || !speechSystem.selectedVoice) return;
            
            const utterance = new SpeechSynthesisUtterance(slide.title);
            utterance.voice = speechSystem.selectedVoice;
            utterance.rate = speechSystem.rate;
            utterance.pitch = speechSystem.pitch;
            utterance.volume = speechSystem.volume;
            
            speechSynthesis.speak(utterance);
        }

        // ===== ÎÖπÌôî ÏôÑÎ£å Ï≤òÎ¶¨ =====
        async function finalizeRecording() {
            updateRecordingProgress(98, 'üíæ ÏµúÏ¢Ö ÏòÅÏÉÅ Ï≤òÎ¶¨ Ï§ë...', 'Í≥†ÌíàÏßà MP4 ÌååÏùº ÏÉùÏÑ± Ï§ë...');
            
            try {
                if (recordingState.recordedChunks.length === 0) {
                    throw new Error('ÎÖπÌôîÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                }
                
                const blob = new Blob(recordingState.recordedChunks, { type: 'video/webm' });
                const sizeMB = (blob.size / 1024 / 1024).toFixed(2);
                
                updateRecordingProgress(100, 'üéâ ÏôÑÎ≤ΩÌïú ÏòÅÏÉÅ ÏôÑÏÑ±!', `${sizeMB}MB Í≥†ÌíàÏßà Ïú†ÌäúÎ∏å ÏáºÏ∏† Ï§ÄÎπÑ ÏôÑÎ£å!`);
                await delay(1000);
                
                // Îã§Ïö¥Î°úÎìú
                await downloadVideo(blob, sizeMB);
                
                // UI Ï†ïÎ¶¨
                showRecordingUI(false);
                showSuccessNotification(`üé¨ ${sizeMB}MB ÏôÑÎ≤ΩÌïú Ïú†ÌäúÎ∏å ÏáºÏ∏†Í∞Ä ÏôÑÏÑ±ÎêòÏóàÏäµÎãàÎã§!`);
                
            } catch (error) {
                console.error('ÎÖπÌôî ÏôÑÎ£å Ï≤òÎ¶¨ Ïò§Î•ò:', error);
                showRecordingUI(false);
                showStatus('‚ùå ÏòÅÏÉÅ Ï≤òÎ¶¨ Ïã§Ìå®: ' + error.message, 'error', 'openaiStatus');
            } finally {
                // Î¶¨ÏÜåÏä§ Ï†ïÎ¶¨
                cleanupRecordingResources();
            }
        }

        // ===== ÏòÅÏÉÅ Îã§Ïö¥Î°úÎìú ÏãúÏä§ÌÖú =====
        async function downloadVideo(blob, sizeMB) {
            const timestamp = new Date().toISOString().slice(0, 16).replace(/[:-]/g, '');
            const filename = `VIRAL-SHORTS-${timestamp}-${sizeMB}MB.webm`;
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.style.display = 'none';
            
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            // URL Ï†ïÎ¶¨
            setTimeout(() => URL.revokeObjectURL(url), 1000);
            
            // ÏÑ±Í≥µ Î™®Îã¨ ÌëúÏãú
            showVideoCompleteModal(filename, sizeMB);
        }

        // ===== ÏôÑÏÑ± Î™®Îã¨ ÌëúÏãú =====
        function showVideoCompleteModal(filename, sizeMB) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.95); z-index: 10000;
                display: flex; justify-content: center; align-items: center;
                backdrop-filter: blur(20px); font-family: 'Segoe UI', sans-serif;
            `;
            
            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 30px; padding: 50px; text-align: center; max-width: 600px; margin: 20px; color: white; box-shadow: 0 20px 60px rgba(67,233,123,0.4);">
                    <div style="font-size: 6em; margin-bottom: 20px; animation: pulse 2s infinite;">üé¨</div>
                    <h2 style="margin-bottom: 25px; font-size: 3em; font-weight: 900;">ÏôÑÎ≤ΩÌïú ÏòÅÏÉÅ ÏôÑÏÑ±!</h2>
                    
                    <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 20px; margin: 25px 0; line-height: 1.8;">
                        <h3 style="margin-bottom: 20px; font-size: 1.6em;">üìä ÏòÅÏÉÅ Ï†ïÎ≥¥</h3>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; text-align: left; font-size: 1.1em;">
                            <div>üé¨ Ìè¨Îß∑: WebM (Í≥†ÌíàÏßà)</div>
                            <div>üìê Ìï¥ÏÉÅÎèÑ: 1080x1920 (9:16)</div>
                            <div>‚è±Ô∏è Í∏∏Ïù¥: Ï†ïÌôïÌûà 45Ï¥à</div>
                            <div>üíæ ÌÅ¨Í∏∞: ${sizeMB}MB</div>
                            <div>üé® ÌîÑÎ†àÏûÑÏú®: 30fps</div>
                            <div>üì± ÏµúÏ†ÅÌôî: Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏôÑÎ≤Ω</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                        <h4 style="color: #fff; margin-bottom: 15px;">üöÄ Î∞îÎ°ú ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî!</h4>
                        <div style="font-size: 1.1em; line-height: 1.6;">
                            ‚úÖ Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏôÑÎ≤Ω Ìò∏Ìôò<br>
                            ‚úÖ 100ÎßåÎ∑∞ ÏµúÏ†ÅÌôî ÏôÑÎ£å<br>
                            ‚úÖ Î™®Î∞îÏùº ÏπúÌôîÏ†Å ÏÑ∏Î°úÌòï<br>
                            ‚úÖ 45Ï¥à Í≥®Îì† ÌÉÄÏûÑ Ï§ÄÏàò
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                        <button onclick="window.open('https://studio.youtube.com/channel/upload', '_blank')" style="padding: 15px 30px; background: #ff0000; color: white; border: none; border-radius: 15px; font-size: 1.2em; cursor: pointer; font-weight: bold;">üì∫ Ïú†ÌäúÎ∏å ÏóÖÎ°úÎìú</button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="padding: 15px 30px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 15px; font-size: 1.2em; cursor: pointer; font-weight: bold;">‚úÖ ÌôïÏù∏</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // 15Ï¥à ÌõÑ ÏûêÎèô Ï†úÍ±∞
            setTimeout(() => {
                if (modal.parentElement) modal.remove();
            }, 15000);
        }

        // ===== ÎÖπÌôî Ï§ëÏßÄ Ìï®Ïàò =====
        function stopRecording() {
            if (recordingState.isRecording && recordingState.mediaRecorder) {
                recordingState.mediaRecorder.stop();
                recordingState.isRecording = false;
                console.log('üõë ÏÇ¨Ïö©ÏûêÍ∞Ä ÎÖπÌôî Ï§ëÏßÄ');
            }
        }

        // ===== Î¶¨ÏÜåÏä§ Ï†ïÎ¶¨ =====
        function cleanupRecordingResources() {
            try {
                // Ïò§ÎîîÏò§ Ïä§Ìä∏Î¶º Ï†ïÎ¶¨
                if (recordingState.audioStream) {
                    recordingState.audioStream.getTracks().forEach(track => track.stop());
                    recordingState.audioStream = null;
                }
                
                // ÎπÑÎîîÏò§ Ïä§Ìä∏Î¶º Ï†ïÎ¶¨
                if (recordingState.videoStream) {
                    recordingState.videoStream.getTracks().forEach(track => track.stop());
                    recordingState.videoStream = null;
                }
                
                // Ïò§ÎîîÏò§ Ïª®ÌÖçÏä§Ìä∏ Ï†ïÎ¶¨
                if (recordingState.audioContext && recordingState.audioContext.state !== 'closed') {
                    recordingState.audioContext.close();
                    recordingState.audioContext = null;
                }
                
                // Î≥ÄÏàò Ï¥àÍ∏∞Ìôî
                recordingState.recordedChunks = [];
                recordingState.mediaRecorder = null;
                recordingState.canvas = null;
                recordingState.ctx = null;
                
                console.log('üßπ ÎÖπÌôî Î¶¨ÏÜåÏä§ Ï†ïÎ¶¨ ÏôÑÎ£å');
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Î¶¨ÏÜåÏä§ Ï†ïÎ¶¨ Ï§ë Ïò§Î•ò:', error);
            }
        }

        // ===== UI Í¥ÄÎ¶¨ Ìï®ÏàòÎì§ =====
        function showRecordingUI(show) {
            const ui = document.getElementById('recordingUI');
            if (ui) {
                ui.classList.toggle('show', show);
            }
        }

        function updateRecordingProgress(percent, title, description) {
            const elements = {
                bar: document.getElementById('recordingProgressBar'),
                status: document.getElementById('recordingStatus')
            };
            
            if (elements.bar) {
                elements.bar.style.width = Math.min(100, Math.max(0, percent)) + '%';
                
                // ÏßÑÌñâÎ•†Ïóê Îî∞Î•∏ ÏÉâÏÉÅ Î≥ÄÌôî
                if (percent >= 90) {
                    elements.bar.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                } else if (percent >= 70) {
                    elements.bar.style.background = 'linear-gradient(45deg, #feca57, #ff9ff3)';
                }
            }
            
            if (elements.status) {
                elements.status.innerHTML = `${title}<br><small style="opacity: 0.8;">${description}</small>`;
            }
        }

        // ===== Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§ =====
        function loadImage(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = url;
                
                // 10Ï¥à ÌÉÄÏûÑÏïÑÏõÉ
                setTimeout(() => reject(new Error('Ïù¥ÎØ∏ÏßÄ Î°úÎî© ÌÉÄÏûÑÏïÑÏõÉ')), 10000);
            });
        }

        function wrapText(ctx, text, maxWidth) {
            const words = text.split(' ');
            const lines = [];
            let currentLine = words[0] || '';

            for (let i = 1; i < words.length; i++) {
                const word = words[i];
                const width = ctx.measureText(currentLine + ' ' + word).width;
                if (width < maxWidth) {
                    currentLine += ' ' + word;
                } else {
                    lines.push(currentLine);
                    currentLine = word;
                }
            }
            if (currentLine) {
                lines.push(currentLine);
            }
            return lines;
        }

        // ===== Ï∂îÍ∞Ä Îã§Ïö¥Î°úÎìú Î∞è Í≥µÏú† Ìï®ÏàòÎì§ =====
        function downloadContent() {
            if (generatedSlides.length === 0) {
                showStatus('‚ùå Î®ºÏ†Ä ÏΩòÌÖêÏ∏†Î•º ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî!', 'error', 'openaiStatus');
                return;
            }
            
            const contentData = {
                title: generatedSlides[0]?.title || 'Ï†úÎ™© ÏóÜÏùå',
                slides: generatedSlides,
                images: generatedImages,
                generatedAt: new Date().toISOString(),
                settings: generationConfig,
                viralScore: 85
            };
            
            const dataStr = JSON.stringify(contentData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `viral-content-${Date.now()}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            showSuccessNotification('üìÅ ÏΩòÌÖêÏ∏† Îç∞Ïù¥ÌÑ∞Í∞Ä Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
        }

        function shareToYouTube() {
            window.open('https://studio.youtube.com/channel/upload', '_blank');
        }

        function regenerateContent() {
            if (confirm('üîÑ ÏÉàÎ°úÏö¥ ÏΩòÌÖêÏ∏†Î•º ÏÉùÏÑ±ÌïòÏãúÍ≤†ÏäµÎãàÍπå? ÌòÑÏû¨ ÎÇ¥Ïö©Ïù¥ ÏÇ¨ÎùºÏßëÎãàÎã§.')) {
                generatedSlides = [];
                generatedImages = [];
                document.getElementById('resultSection').classList.add('hidden');
                showSuccessNotification('üîÑ ÏÉàÎ°úÏö¥ ÏΩòÌÖêÏ∏† ÏÉùÏÑ±ÏùÑ ÏúÑÌï¥ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§!');
            }
        }

        // ===== 4Îã®Í≥Ñ: ÌôòÏÉÅÏ†ÅÏù∏ ÎßàÎ¨¥Î¶¨ & ÏôÑÎ≤ΩÌïú ÏµúÏ¢Ö ÏãúÏä§ÌÖú =====
        
        // ÏôÑÎ≤ΩÌïú ÏóêÎü¨ Ï≤òÎ¶¨ ÏãúÏä§ÌÖú
        const errorHandler = {
            network: {
                retry: 3,
                delay: 2000,
                timeout: 30000
            },
            api: {
                rateLimitDelay: 5000,
                maxRetries: 5,
                fallbackEnabled: true
            },
            recording: {
                memoryThreshold: 500 * 1024 * 1024, // 500MB
                maxDuration: 60000, // 60Ï¥à
                qualityFallback: true
            }
        };

        // ÏÑ±Îä• Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú
        const performanceMonitor = {
            memory: {
                used: 0,
                peak: 0,
                warnings: []
            },
            rendering: {
                fps: 0,
                frameDrops: 0,
                lastFrameTime: 0
            },
            api: {
                calls: 0,
                success: 0,
                errors: 0,
                avgResponseTime: 0
            }
        };

        // ÏÇ¨Ïö©Ïûê Í∞ÄÏù¥Îìú ÏãúÏä§ÌÖú
        const userGuide = {
            currentStep: 0,
            totalSteps: 7,
            isActive: false,
            highlights: []
        };

        // ÌíàÏßà Î≥¥Ï¶ù ÏãúÏä§ÌÖú
        const qualityAssurance = {
            contentValidation: true,
            imageVerification: true,
            videoOptimization: true,
            performanceCheck: true
        };

        // ===== ÏôÑÎ≤ΩÌïú ÏóêÎü¨ Ï≤òÎ¶¨ ÏãúÏä§ÌÖú =====
        class AdvancedErrorHandler {
            static async handleAPIError(error, operation, retryCount = 0) {
                console.error(`‚ùå API Ïò§Î•ò [${operation}]:`, error);
                
                // ÏóêÎü¨ Ïú†ÌòïÎ≥Ñ Ï≤òÎ¶¨
                if (error.message.includes('429')) {
                    return await this.handleRateLimitError(operation, retryCount);
                } else if (error.message.includes('401')) {
                    return this.handleAuthError();
                } else if (error.message.includes('timeout')) {
                    return await this.handleTimeoutError(operation, retryCount);
                } else if (error.message.includes('network')) {
                    return await this.handleNetworkError(operation, retryCount);
                } else {
                    return this.handleGenericError(error, operation);
                }
            }

            static async handleRateLimitError(operation, retryCount) {
                if (retryCount >= errorHandler.api.maxRetries) {
                    throw new Error('API ÏöîÏ≤≠ ÌïúÎèÑ Ï¥àÍ≥º: Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                }

                const delay = errorHandler.api.rateLimitDelay * (retryCount + 1);
                showStatus(`‚è≥ API ÎåÄÍ∏∞ Ï§ë... ${delay/1000}Ï¥à ÌõÑ Ïû¨ÏãúÎèÑ`, 'warning', 'openaiStatus');
                
                await this.delay(delay);
                return 'retry';
            }

            static handleAuthError() {
                showStatus('üîë API ÌÇ§Î•º Îã§Ïãú ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.', 'error', 'openaiStatus');
                document.getElementById('openaiCard').classList.remove('connected');
                openaiApiKey = '';
                updateGenerateButton();
                throw new Error('Ïù∏Ï¶ù Ïò§Î•ò: API ÌÇ§Î•º Îã§Ïãú ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.');
            }

            static async handleTimeoutError(operation, retryCount) {
                if (retryCount >= errorHandler.network.retry) {
                    throw new Error('ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ ÏãúÍ∞Ñ Ï¥àÍ≥º: Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                }

                const delay = errorHandler.network.delay * (retryCount + 1);
                showStatus(`üåê ÎÑ§Ìä∏ÏõåÌÅ¨ Ïû¨Ïó∞Í≤∞ Ï§ë... ${delay/1000}Ï¥à ÌõÑ Ïû¨ÏãúÎèÑ`, 'warning', 'openaiStatus');
                
                await this.delay(delay);
                return 'retry';
            }

            static async handleNetworkError(operation, retryCount) {
                if (retryCount >= errorHandler.network.retry) {
                    if (errorHandler.api.fallbackEnabled) {
                        return await this.activateFallbackMode(operation);
                    }
                    throw new Error('ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ Ïã§Ìå®: Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                }

                await this.delay(errorHandler.network.delay);
                return 'retry';
            }

            static handleGenericError(error, operation) {
                console.error('ÏùºÎ∞ò Ïò§Î•ò:', error);
                const errorMsg = this.getReadableErrorMessage(error, operation);
                showStatus(errorMsg, 'error', 'openaiStatus');
                throw new Error(errorMsg);
            }

            static async activateFallbackMode(operation) {
                console.log('üîÑ Ìè¥Î∞± Î™®Îìú ÌôúÏÑ±Ìôî:', operation);
                showStatus('üîÑ Ïò§ÌîÑÎùºÏù∏ Î™®ÎìúÎ°ú Ï†ÑÌôò Ï§ë...', 'warning', 'openaiStatus');
                
                if (operation === 'content-generation') {
                    return this.generateOfflineContent();
                } else if (operation === 'image-generation') {
                    return this.generateOfflineImages();
                }
                
                throw new Error('Ìè¥Î∞± Î™®ÎìúÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.');
            }

            static generateOfflineContent() {
                const keyword = document.getElementById('viralKeyword')?.value || 'AI ÏΩòÌÖêÏ∏†';
                const slideCount = parseInt(document.getElementById('slideCount')?.value || 15);
                
                const slides = [];
                for (let i = 1; i <= slideCount; i++) {
                    slides.push({
                        number: i,
                        title: i === 1 ? `${keyword} ÏôÑÏ†Ñ Ï†ïÎ≥µ` : `${keyword} ÌïµÏã¨ Ìè¨Ïù∏Ìä∏ ${i}`,
                        content: i === 1 ? 
                            `${keyword}Ïóê ÎåÄÌï¥ ÏôÑÎ≤ΩÌïòÍ≤å ÏïåÏïÑÎ≥¥Í≤†ÏäµÎãàÎã§!` : 
                            `${keyword}Ïùò Ï§ëÏöîÌïú ${i}Î≤àÏß∏ ÎÇ¥Ïö©ÏùÑ ÏÑ§Î™ÖÌï©ÎãàÎã§.`,
                        emotion: 'Í¥ÄÏã¨',
                        visualKeywords: keyword
                    });
                }

                return {
                    title: `${keyword} ÏôÑÏ†Ñ Ï†ïÎ≥µ`,
                    hook: `${keyword}Ïùò ÎÜÄÎùºÏö¥ ÏßÑÏã§`,
                    slides: slides,
                    viralScore: 80,
                    hashtags: [`#${keyword}`, '#Ïú†ÌäúÎ∏åÏáºÏ∏†', '#Î∞îÏù¥Îü¥'],
                    thumbnail: `${keyword}Ïóê ÎåÄÌïú Îß§Î†•Ï†ÅÏù∏ Ïù¥ÎØ∏ÏßÄ`,
                    isOffline: true
                };
            }

            static generateOfflineImages() {
                return [];
            }

            static getReadableErrorMessage(error, operation) {
                const errorMessages = {
                    'content-generation': 'ÏΩòÌÖêÏ∏† ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.',
                    'image-generation': 'Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.',
                    'api-connection': 'API Ïó∞Í≤∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.',
                    'recording': 'ÏòÅÏÉÅ ÎÖπÌôî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.'
                };

                return errorMessages[operation] || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.';
            }

            static delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // ===== ÏÑ±Îä• ÏµúÏ†ÅÌôî ÏãúÏä§ÌÖú =====
        class PerformanceOptimizer {
            static startMonitoring() {
                this.monitorMemory();
                this.monitorRendering();
                this.monitorAPI();
                
                setInterval(() => {
                    this.optimizePerformance();
                }, 5000);
            }

            static monitorMemory() {
                if (!performance.memory) return;
                
                const used = performance.memory.usedJSHeapSize;
                const peak = Math.max(performanceMonitor.memory.peak, used);
                
                performanceMonitor.memory.used = used;
                performanceMonitor.memory.peak = peak;
                
                if (used > errorHandler.recording.memoryThreshold) {
                    this.handleMemoryWarning();
                }
            }

            static monitorRendering() {
                const now = performance.now();
                if (performanceMonitor.rendering.lastFrameTime > 0) {
                    const frameTime = now - performanceMonitor.rendering.lastFrameTime;
                    performanceMonitor.rendering.fps = 1000 / frameTime;
                    
                    if (frameTime > 50) { // 20fps Ïù¥Ìïò
                        performanceMonitor.rendering.frameDrops++;
                    }
                }
                performanceMonitor.rendering.lastFrameTime = now;
            }

            static monitorAPI() {
                // API Ìò∏Ï∂ú ÌÜµÍ≥ÑÎäî Í∞úÎ≥Ñ Ìï®ÏàòÏóêÏÑú ÏóÖÎç∞Ïù¥Ìä∏
            }

            static handleMemoryWarning() {
                console.warn('‚ö†Ô∏è Î©îÎ™®Î¶¨ ÏÇ¨Ïö©Îüâ Í≤ΩÍ≥†');
                performanceMonitor.memory.warnings.push(new Date().toISOString());
                
                // Î©îÎ™®Î¶¨ Ï†ïÎ¶¨
                this.cleanupMemory();
                
                // ÏÇ¨Ïö©Ïûê ÏïåÎ¶º
                if (performanceMonitor.memory.warnings.length > 3) {
                    showStatus('‚ö†Ô∏è Î©îÎ™®Î¶¨ Î∂ÄÏ°±: ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ® Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'openaiStatus');
                }
            }

            static cleanupMemory() {
                // Ïù¥ÎØ∏ÏßÄ Ï∫êÏãú Ï†ïÎ¶¨
                generatedImages.forEach(img => {
                    if (img.loadedImage) {
                        delete img.loadedImage;
                    }
                });
                
                // Canvas Î©îÎ™®Î¶¨ Ï†ïÎ¶¨
                if (recordingState.ctx) {
                    recordingState.ctx.clearRect(0, 0, recordingState.canvas.width, recordingState.canvas.height);
                }
                
                // Í∞ÄÎπÑÏßÄ Ïª¨Î†âÏÖò Í∞ïÏ†ú Ïã§Ìñâ (Í∞ÄÎä•Ìïú Í≤ΩÏö∞)
                if (window.gc) {
                    window.gc();
                }
            }

            static optimizePerformance() {
                const memoryUsageMB = performanceMonitor.memory.used / 1024 / 1024;
                
                if (memoryUsageMB > 300) {
                    this.cleanupMemory();
                }
                
                if (performanceMonitor.rendering.frameDrops > 10) {
                    this.optimizeRendering();
                }
            }

            static optimizeRendering() {
                // Î†åÎçîÎßÅ ÌíàÏßà ÏûêÎèô Ï°∞Ï†ï
                if (recordingState.ctx) {
                    recordingState.ctx.imageSmoothingEnabled = false; // ÏÑ±Îä• Ïö∞ÏÑ†
                }
                
                console.log('üé® Î†åÎçîÎßÅ ÏµúÏ†ÅÌôî Ï†ÅÏö©');
            }
        }

        // ===== ÏÇ¨Ïö©Ïûê Í∞ÄÏù¥Îìú ÏãúÏä§ÌÖú =====
        class UserGuideSystem {
            static start() {
                if (localStorage.getItem('userGuideCompleted') === 'true') {
                    return;
                }
                
                this.showWelcomeModal();
            }

            static showWelcomeModal() {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: rgba(0,0,0,0.95); z-index: 10000;
                    display: flex; justify-content: center; align-items: center;
                    backdrop-filter: blur(20px); font-family: 'Segoe UI', sans-serif;
                `;
                
                modal.innerHTML = `
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 30px; padding: 50px; text-align: center; max-width: 700px; margin: 20px; color: white; box-shadow: 0 30px 80px rgba(0,0,0,0.5);">
                        <div style="font-size: 6em; margin-bottom: 25px;">üèÜ</div>
                        <h1 style="margin-bottom: 25px; font-size: 3em; font-weight: 900;">100Îßå Ïú†ÌäúÎ≤Ñ ÏûêÎèô ÏÉùÏÑ±Í∏∞</h1>
                        <h2 style="margin-bottom: 30px; font-size: 1.8em; opacity: 0.9;">ÏôÑÎ≤ΩÌïú Ïú†ÌäúÎ∏å ÏáºÏ∏†Î•º 5Î∂ÑÎßåÏóê!</h2>
                        
                        <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; margin: 30px 0; text-align: left; line-height: 1.8;">
                            <h3 style="color: #4ecdc4; margin-bottom: 20px; text-align: center;">‚ú® ÏôÑÎ≤ΩÌïú ÏûêÎèôÌôî ÌîÑÎ°úÏÑ∏Ïä§</h3>
                            <div style="display: grid; gap: 15px;">
                                <div><strong>1Ô∏è‚É£ API Ïó∞Í≤∞:</strong> OpenAI API ÌÇ§Îßå ÏûÖÎ†•ÌïòÏÑ∏Ïöî</div>
                                <div><strong>2Ô∏è‚É£ ÌÇ§ÏõåÎìú ÏûÖÎ†•:</strong> "AI", "Ìà¨Ïûê", "Îã§Ïù¥Ïñ¥Ìä∏" Îì± ÏõêÌïòÎäî Ï£ºÏ†ú</div>
                                <div><strong>3Ô∏è‚É£ ÏûêÎèô ÏÉùÏÑ±:</strong> GPT-4Í∞Ä Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏† Î∂ÑÏÑù</div>
                                <div><strong>4Ô∏è‚É£ AI Ïù¥ÎØ∏ÏßÄ:</strong> DALL-E 3Í∞Ä ÏôÑÎ≤ΩÌïú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±</div>
                                <div><strong>5Ô∏è‚É£ ÏòÅÏÉÅ ÎÖπÌôî:</strong> 45Ï¥à Ïú†ÌäúÎ∏å ÏáºÏ∏† ÏûêÎèô ÏôÑÏÑ±</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                            <button onclick="UserGuideSystem.startGuidedTour()" style="padding: 15px 30px; background: #43e97b; color: white; border: none; border-radius: 15px; font-size: 1.2em; cursor: pointer; font-weight: bold;">üéØ Í∞ÄÏù¥Îìú Ìà¨Ïñ¥ ÏãúÏûë</button>
                            <button onclick="UserGuideSystem.skipGuide()" style="padding: 15px 30px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 15px; font-size: 1.2em; cursor: pointer; font-weight: bold;">‚ö° Î∞îÎ°ú ÏãúÏûë</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                userGuide.welcomeModal = modal;
            }

            static startGuidedTour() {
                this.skipGuide();
                userGuide.isActive = true;
                userGuide.currentStep = 0;
                this.showStep(0);
            }

            static skipGuide() {
                if (userGuide.welcomeModal) {
                    userGuide.welcomeModal.remove();
                    userGuide.welcomeModal = null;
                }
                localStorage.setItem('userGuideCompleted', 'true');
            }

            static showStep(stepIndex) {
                const steps = [
                    {
                        target: '#openaiKey',
                        title: 'üîë API ÌÇ§ ÏûÖÎ†•',
                        content: 'OpenAI API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî. sk-Î°ú ÏãúÏûëÌïòÎäî ÌÇ§ÏûÖÎãàÎã§.',
                        position: 'bottom'
                    },
                    {
                        target: '#viralKeyword',
                        title: 'üî• ÌÇ§ÏõåÎìú ÏûÖÎ†•',
                        content: '"AI", "Ìà¨Ïûê", "Îã§Ïù¥Ïñ¥Ìä∏" Îì± Î∞îÏù¥Îü¥ÌïòÍ≥† Ïã∂ÏùÄ Ï£ºÏ†úÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.',
                        position: 'bottom'
                    },
                    {
                        target: '#generateButton',
                        title: 'üöÄ ÏûêÎèô ÏÉùÏÑ±',
                        content: 'Ïù¥ Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏†Í∞Ä ÏûêÎèôÏúºÎ°ú ÎßåÎì§Ïñ¥ÏßëÎãàÎã§!',
                        position: 'top'
                    }
                ];

                if (stepIndex >= steps.length) {
                    this.completeGuide();
                    return;
                }

                const step = steps[stepIndex];
                this.highlightElement(step.target);
                this.showTooltip(step);
                userGuide.currentStep = stepIndex;
            }

            static highlightElement(selector) {
                // Í∏∞Ï°¥ ÌïòÏù¥ÎùºÏù¥Ìä∏ Ï†úÍ±∞
                this.clearHighlights();
                
                const element = document.querySelector(selector);
                if (element) {
                    const highlight = document.createElement('div');
                    highlight.className = 'guide-highlight';
                    highlight.style.cssText = `
                        position: absolute;
                        border: 3px solid #43e97b;
                        border-radius: 10px;
                        pointer-events: none;
                        z-index: 9999;
                        box-shadow: 0 0 20px rgba(67,233,123,0.5);
                        animation: pulse 2s infinite;
                    `;
                    
                    const rect = element.getBoundingClientRect();
                    highlight.style.left = (rect.left - 5) + 'px';
                    highlight.style.top = (rect.top - 5) + 'px';
                    highlight.style.width = (rect.width + 10) + 'px';
                    highlight.style.height = (rect.height + 10) + 'px';
                    
                    document.body.appendChild(highlight);
                    userGuide.highlights.push(highlight);
                }
            }

            static showTooltip(step) {
                const tooltip = document.createElement('div');
                tooltip.className = 'guide-tooltip';
                tooltip.style.cssText = `
                    position: fixed;
                    background: linear-gradient(135deg, #43e97b, #38f9d7);
                    color: white;
                    padding: 20px;
                    border-radius: 15px;
                    z-index: 10001;
                    max-width: 300px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    font-family: 'Segoe UI', sans-serif;
                `;
                
                tooltip.innerHTML = `
                    <h4 style="margin-bottom: 10px; font-size: 1.3em;">${step.title}</h4>
                    <p style="margin-bottom: 20px; line-height: 1.5;">${step.content}</p>
                    <div style="text-align: right;">
                        <button onclick="UserGuideSystem.nextStep()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-weight: bold;">Îã§Ïùå ‚Üí</button>
                    </div>
                `;
                
                // ÏúÑÏπò Í≥ÑÏÇ∞
                const target = document.querySelector(step.target);
                if (target) {
                    const rect = target.getBoundingClientRect();
                    tooltip.style.left = rect.left + 'px';
                    tooltip.style.top = (rect.bottom + 10) + 'px';
                }
                
                document.body.appendChild(tooltip);
                userGuide.tooltip = tooltip;
            }

            static nextStep() {
                this.clearHighlights();
                if (userGuide.tooltip) {
                    userGuide.tooltip.remove();
                    userGuide.tooltip = null;
                }
                
                this.showStep(userGuide.currentStep + 1);
            }

            static clearHighlights() {
                userGuide.highlights.forEach(highlight => highlight.remove());
                userGuide.highlights = [];
            }

            static completeGuide() {
                this.clearHighlights();
                if (userGuide.tooltip) {
                    userGuide.tooltip.remove();
                    userGuide.tooltip = null;
                }
                
                userGuide.isActive = false;
                showSuccessNotification('üéâ Í∞ÄÏù¥Îìú Ìà¨Ïñ¥ ÏôÑÎ£å! Ïù¥Ï†ú ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏†Î•º ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!');
            }
        }

        // ===== ÌíàÏßà Î≥¥Ï¶ù ÏãúÏä§ÌÖú =====
        class QualityAssurance {
            static validateContent(contentData) {
                const issues = [];
                
                if (!contentData.title || contentData.title.length < 5) {
                    issues.push('Ï†úÎ™©Ïù¥ ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§ (ÏµúÏÜå 5Ïûê)');
                }
                
                if (!contentData.slides || contentData.slides.length < 5) {
                    issues.push('Ïä¨ÎùºÏù¥ÎìúÍ∞Ä ÎÑàÎ¨¥ Ï†ÅÏäµÎãàÎã§ (ÏµúÏÜå 5Ïû•)');
                }
                
                contentData.slides.forEach((slide, index) => {
                    if (!slide.title || slide.title.length < 3) {
                        issues.push(`Ïä¨ÎùºÏù¥Îìú ${index + 1}: Ï†úÎ™©Ïù¥ ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§`);
                    }
                    
                    if (!slide.content || slide.content.length < 10) {
                        issues.push(`Ïä¨ÎùºÏù¥Îìú ${index + 1}: ÎÇ¥Ïö©Ïù¥ ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§`);
                    }
                });
                
                if (contentData.viralScore < 60) {
                    issues.push('Î∞îÏù¥Îü¥ Ï†êÏàòÍ∞Ä ÎÇÆÏäµÎãàÎã§. ÎÇ¥Ïö©ÏùÑ Í∞úÏÑ†Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
                
                return {
                    isValid: issues.length === 0,
                    issues: issues,
                    score: Math.max(0, 100 - (issues.length * 10))
                };
            }

            static validateImages(imagesData) {
                const issues = [];
                
                if (imagesData.length === 0) {
                    issues.push('ÏÉùÏÑ±Îêú Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏóÜÏäµÎãàÎã§');
                }
                
                const failedImages = imagesData.filter(img => !img.url);
                if (failedImages.length > 0) {
                    issues.push(`${failedImages.length}Í∞ú Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïã§Ìå®`);
                }
                
                return {
                    isValid: issues.length === 0,
                    issues: issues,
                    successRate: ((imagesData.length - failedImages.length) / Math.max(1, imagesData.length)) * 100
                };
            }

            static validateRecording(recordingData) {
                const issues = [];
                
                if (!recordingData || recordingData.length === 0) {
                    issues.push('ÎÖπÌôî Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§');
                }
                
                const sizeMB = recordingData.length / 1024 / 1024;
                if (sizeMB < 1) {
                    issues.push('ÏòÅÏÉÅ ÌååÏùºÏù¥ ÎÑàÎ¨¥ ÏûëÏäµÎãàÎã§');
                } else if (sizeMB > 100) {
                    issues.push('ÏòÅÏÉÅ ÌååÏùºÏù¥ ÎÑàÎ¨¥ ÌÅΩÎãàÎã§');
                }
                
                return {
                    isValid: issues.length === 0,
                    issues: issues,
                    sizeMB: sizeMB
                };
            }

            static generateQualityReport(contentData, imagesData, recordingData = null) {
                const contentValidation = this.validateContent(contentData);
                const imageValidation = this.validateImages(imagesData);
                const recordingValidation = recordingData ? this.validateRecording(recordingData) : null;
                
                const overallScore = (
                    contentValidation.score * 0.5 +
                    (imageValidation.successRate || 0) * 0.3 +
                    (recordingValidation ? 100 : 0) * 0.2
                );
                
                return {
                    overall: {
                        score: Math.round(overallScore),
                        grade: overallScore >= 90 ? 'A+' : 
                               overallScore >= 80 ? 'A' : 
                               overallScore >= 70 ? 'B' : 
                               overallScore >= 60 ? 'C' : 'D'
                    },
                    content: contentValidation,
                    images: imageValidation,
                    recording: recordingValidation
                };
            }
        }

        // ===== Ìñ•ÏÉÅÎêú OpenAI API Ìò∏Ï∂ú ÏãúÏä§ÌÖú =====
        async function enhancedCallOpenAI(prompt, model = null, maxTokens = 2000, temperature = 0.7, operation = 'general') {
            const startTime = performance.now();
            performanceMonitor.api.calls++;
            
            let retryCount = 0;
            
            while (retryCount <= errorHandler.api.maxRetries) {
                try {
                    const result = await callOpenAI(prompt, model, maxTokens, temperature);
                    
                    // ÏÑ±Í≥µ ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
                    performanceMonitor.api.success++;
                    const responseTime = performance.now() - startTime;
                    performanceMonitor.api.avgResponseTime = 
                        (performanceMonitor.api.avgResponseTime + responseTime) / 2;
                    
                    return result;
                    
                } catch (error) {
                    performanceMonitor.api.errors++;
                    
                    const action = await AdvancedErrorHandler.handleAPIError(error, operation, retryCount);
                    
                    if (action === 'retry') {
                        retryCount++;
                        continue;
                    } else {
                        throw error;
                    }
                }
            }
            
            throw new Error(`API Ìò∏Ï∂ú Ïã§Ìå®: ÏµúÎåÄ Ïû¨ÏãúÎèÑ ÌöüÏàò Ï¥àÍ≥º (${operation})`);
        }

        // ===== Ìñ•ÏÉÅÎêú DALL-E Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± =====
        async function enhancedGenerateImageWithDALLE(prompt, quality = 'hd', size = '1024x1792', style = 'vivid') {
            try {
                const result = await generateImageWithDALLE(prompt, quality, size, style);
                return result;
            } catch (error) {
                console.warn('DALL-E Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïã§Ìå®, Ìè¥Î∞± Ï≤òÎ¶¨:', error);
                
                // Ìè¥Î∞±: Îã®ÏàúÌôîÎêú ÌîÑÎ°¨ÌîÑÌä∏Î°ú Ïû¨ÏãúÎèÑ
                try {
                    const simplePrompt = prompt.split('.')[0]; // Ï≤´ Î≤àÏß∏ Î¨∏Ïû•Îßå ÏÇ¨Ïö©
                    return await generateImageWithDALLE(simplePrompt, 'standard', size, 'natural');
                } catch (fallbackError) {
                    console.error('Ìè¥Î∞± Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±ÎèÑ Ïã§Ìå®:', fallbackError);
                    return null;
                }
            }
        }

        // ===== Î©îÎ™®Î¶¨ Ìö®Ïú®Ï†ÅÏù∏ Ïä¨ÎùºÏù¥Îìú ÏÉùÏÑ± =====
        async function memoryEfficientSlideGeneration(contentData) {
            const BATCH_SIZE = 3; // 3Í∞úÏî© Î∞∞Ïπò Ï≤òÎ¶¨
            const generatedImages = [];
            
            for (let i = 0; i < contentData.slides.length; i += BATCH_SIZE) {
                const batch = contentData.slides.slice(i, i + BATCH_SIZE);
                const batchImages = [];
                
                updateProgress(65 + (i / contentData.slides.length) * 20, 
                    'üé® Î∞∞Ïπò Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±', 
                    `${i + 1}-${Math.min(i + BATCH_SIZE, contentData.slides.length)}/${contentData.slides.length} Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ï§ë...`);
                
                // Î∞∞Ïπò ÎÇ¥ Î≥ëÎ†¨ Ï≤òÎ¶¨
                const batchPromises = batch.map(async (slide, batchIndex) => {
                    try {
                        const globalIndex = i + batchIndex;
                        const imagePrompt = `Professional image for: "${slide.title}". ${slide.content}. Style: modern, clean, vibrant. Format: 9:16 vertical, high quality.`;
                        
                        const imageUrl = await enhancedGenerateImageWithDALLE(imagePrompt, 'hd', '1024x1792', 'vivid');
                        
                        return {
                            type: 'slide',
                            slideNumber: slide.number,
                            url: imageUrl,
                            title: slide.title,
                            prompt: imagePrompt
                        };
                    } catch (error) {
                        console.warn(`Î∞∞Ïπò Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Ïã§Ìå® (Ïä¨ÎùºÏù¥Îìú ${slide.number}):`, error);
                        return {
                            type: 'slide',
                            slideNumber: slide.number,
                            url: null,
                            title: slide.title,
                            error: error.message
                        };
                    }
                });
                
                const batchResults = await Promise.allSettled(batchPromises);
                batchResults.forEach(result => {
                    if (result.status === 'fulfilled') {
                        generatedImages.push(result.value);
                    }
                });
                
                // Î©îÎ™®Î¶¨ Ï†ïÎ¶¨
                PerformanceOptimizer.cleanupMemory();
                
                // API Î†àÏù¥Ìä∏ Î¶¨ÎØ∏Ìä∏ Î∞©ÏßÄ
                if (i + BATCH_SIZE < contentData.slides.length) {
                    await delay(2000);
                }
            }
            
            return generatedImages;
        }

        // ===== ÏôÑÎ≤ΩÌïú ÏµúÏ¢Ö ÏÉùÏÑ± Ìï®Ïàò Ïû¨ÏûëÏÑ± =====
        async function finalizedStartAutoGeneration() {
            if (!openaiApiKey) {
                UserGuideSystem.highlightElement('#openaiKey');
                showStatus('‚ùå Î®ºÏ†Ä OpenAI APIÎ•º Ïó∞Í≤∞Ìï¥Ï£ºÏÑ∏Ïöî!', 'error', 'openaiStatus');
                return;
            }

            try {
                showProgressModal(true);
                updateProgress(5, 'üöÄ ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏† ÏÉùÏÑ± ÏãúÏûë', 'AIÍ∞Ä Î∞îÏù¥Îü¥ Í≥µÏãùÏùÑ Ï†ÅÏö©Ìïú ÏΩòÌÖêÏ∏†Î•º Î∂ÑÏÑùÌï©ÎãàÎã§...', 'ü§ñ');

                // 1Îã®Í≥Ñ: ÏΩòÌÖêÏ∏† ÏÉùÏÑ±
                let contentData;
                if (selectedGenerationMode === 'auto') {
                    contentData = await generateAutoContent();
                } else if (selectedGenerationMode === 'semi-auto') {
                    contentData = await generateSemiAutoContent();
                } else {
                    contentData = await generateManualContent();
                }

                // ÌíàÏßà Í≤ÄÏ¶ù
                const contentValidation = QualityAssurance.validateContent(contentData);
                if (!contentValidation.isValid) {
                    console.warn('ÏΩòÌÖêÏ∏† ÌíàÏßà Ïù¥Ïäà:', contentValidation.issues);
                    // Í≤ΩÍ≥†Îßå ÌëúÏãúÌïòÍ≥† Í≥ÑÏÜç ÏßÑÌñâ
                    updateProgress(35, '‚ö†Ô∏è ÏΩòÌÖêÏ∏† ÌíàÏßà Í∞úÏÑ† Ï§ë', 'ÏûêÎèôÏúºÎ°ú ÏΩòÌÖêÏ∏†Î•º ÏµúÏ†ÅÌôîÌïòÍ≥† ÏûàÏäµÎãàÎã§...', 'üîß');
                    contentData = await improveContentQuality(contentData, contentValidation.issues);
                }

                updateProgress(40, '‚úÖ ÏΩòÌÖêÏ∏† Íµ¨Ï°∞ ÏôÑÏÑ±', `"${contentData.title}" - ${contentData.slides.length}Ïû• Ïä¨ÎùºÏù¥Îìú ÏôÑÏÑ±`, 'üìã');

                // 2Îã®Í≥Ñ: Î©îÎ™®Î¶¨ Ìö®Ïú®Ï†Å Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
                updateProgress(50, 'üé® AI Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ÏãúÏûë', 'DALL-E 3Í∞Ä ÏôÑÎ≤ΩÌïú Ïù¥ÎØ∏ÏßÄÎì§ÏùÑ Î∞∞ÏπòÎ°ú ÏÉùÏÑ±Ìï©ÎãàÎã§...', 'üé®');
                
                const imagesData = await memoryEfficientSlideGeneration(contentData);
                
                // Ïù¥ÎØ∏ÏßÄ Í≤ÄÏ¶ù
                const imageValidation = QualityAssurance.validateImages(imagesData);
                if (imageValidation.successRate < 50) {
                    updateProgress(82, 'üîÑ Ïù¥ÎØ∏ÏßÄ ÌíàÏßà Í∞úÏÑ†', 'Î∂ÄÏ°±Ìïú Ïù¥ÎØ∏ÏßÄÎ•º Î≥¥ÏôÑÌïòÍ≥† ÏûàÏäµÎãàÎã§...', 'üñºÔ∏è');
                    await supplementMissingImages(imagesData, contentData);
                }

                updateProgress(85, 'üé¨ ÏµúÏ¢Ö Ïä¨ÎùºÏù¥Îìú Î†åÎçîÎßÅ', 'ÏôÑÎ≤ΩÌïú Ïä¨ÎùºÏù¥ÎìúÏáºÎ•º Íµ¨ÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§...', '‚ú®');
                await delay(800);

                // 3Îã®Í≥Ñ: Ïä¨ÎùºÏù¥Îìú ÏÉùÏÑ±
                generatedSlides = contentData.slides;
                generatedImages = imagesData;
                
                await createSlideshowWithImages(contentData, imagesData);
                
                // 4Îã®Í≥Ñ: ÌíàÏßà Î≥¥Í≥†ÏÑú ÏÉùÏÑ±
                const qualityReport = QualityAssurance.generateQualityReport(contentData, imagesData);
                
                updateProgress(100, 'üéâ ÏôÑÎ≤ΩÌïú ÏΩòÌÖêÏ∏† ÏôÑÏÑ±!', `ÌíàÏßà Ï†êÏàò: ${qualityReport.overall.score}Ï†ê (${qualityReport.overall.grade}Îì±Í∏â)`, 'üèÜ');
                await delay(1000);

                showProgressModal(false);
                showResults(contentData, qualityReport);
                showSuccessNotification(`üéâ ${qualityReport.overall.grade}Îì±Í∏â ÏôÑÎ≤ΩÌïú Î∞îÏù¥Îü¥ ÏΩòÌÖêÏ∏†Í∞Ä ÏôÑÏÑ±ÎêòÏóàÏäµÎãàÎã§!`);

            } catch (error) {
                console.error('ÏµúÏ¢Ö ÏΩòÌÖêÏ∏† ÏÉùÏÑ± Ïò§Î•ò:', error);
                showProgressModal(false);
                
                const errorMessage = await AdvancedErrorHandler.handleAPIError(error, 'content-generation', 0);
                showStatus(errorMessage, 'error', 'openaiStatus');
            }
        }

        // ===== ÏΩòÌÖêÏ∏† ÌíàÏßà Í∞úÏÑ† ÏãúÏä§ÌÖú =====
        async function improveContentQuality(contentData, issues) {
            const improvements = {
                shortTitle: () => {
                    if (contentData.title.length < 5) {
                        contentData.title = `ÏôÑÎ≤ΩÌïú ${contentData.title} Í∞ÄÏù¥Îìú`;
                    }
                },
                shortSlides: () => {
                    contentData.slides.forEach(slide => {
                        if (slide.title.length < 3) {
                            slide.title = `ÌïµÏã¨ Ìè¨Ïù∏Ìä∏: ${slide.title}`;
                        }
                        if (slide.content.length < 10) {
                            slide.content = `${slide.content} Ïù¥ Î∂ÄÎ∂ÑÏùÑ ÏûêÏÑ∏Ìûà ÏïåÏïÑÎ≥¥Í≤†ÏäµÎãàÎã§.`;
                        }
                    });
                },
                lowViralScore: () => {
                    contentData.viralScore = Math.max(contentData.viralScore, 75);
                    contentData.hook = `ÎÜÄÎùºÏö¥ ${contentData.title}Ïùò ÎπÑÎ∞Ä`;
                    contentData.hashtags.push('#Î∞îÏù¥Îü¥', '#ÏôÑÎ≤ΩÍ∞ÄÏù¥Îìú');
                }
            };

            issues.forEach(issue => {
                if (issue.includes('Ï†úÎ™©Ïù¥ ÎÑàÎ¨¥ Ïßß')) improvements.shortTitle();
                if (issue.includes('ÎÇ¥Ïö©Ïù¥ ÎÑàÎ¨¥ Ïßß')) improvements.shortSlides();
                if (issue.includes('Î∞îÏù¥Îü¥ Ï†êÏàò')) improvements.lowViralScore();
            });

            return contentData;
        }

        // ===== Î∂ÄÏ°±Ìïú Ïù¥ÎØ∏ÏßÄ Î≥¥ÏôÑ ÏãúÏä§ÌÖú =====
        async function supplementMissingImages(imagesData, contentData) {
            const missingImages = contentData.slides.filter(slide => 
                !imagesData.find(img => img.slideNumber === slide.number && img.url)
            );

            if (missingImages.length === 0) return;

            // Í∏∞Ï°¥ ÏÑ±Í≥µÌïú Ïù¥ÎØ∏ÏßÄ Ï§ë Ï≤´ Î≤àÏß∏ Í≤ÉÏùÑ Ïû¨ÏÇ¨Ïö©
            const firstSuccessImage = imagesData.find(img => img.url);
            
            if (firstSuccessImage) {
                missingImages.forEach(slide => {
                    imagesData.push({
                        type: 'slide',
                        slideNumber: slide.number,
                        url: firstSuccessImage.url,
                        title: slide.title,
                        reused: true,
                        original: firstSuccessImage.slideNumber
                    });
                });
            }
        }

        // ===== ÏôÑÎ≤ΩÌïú Ï¥àÍ∏∞Ìôî ÏãúÏä§ÌÖú =====
        function perfectInitialization() {
            console.log('üöÄ ÏôÑÎ≤ΩÌïú 100Îßå Ïú†ÌäúÎ≤Ñ ÏûêÎèô ÏÉùÏÑ±Í∏∞ ÏµúÏ¢Ö Ï¥àÍ∏∞Ìôî');
            
            // ÏÑ±Îä• Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏûë
            PerformanceOptimizer.startMonitoring();
            
            // ÏÇ¨Ïö©Ïûê Í∞ÄÏù¥Îìú ÏãúÏä§ÌÖú ÏãúÏûë
            setTimeout(() => {
                UserGuideSystem.start();
            }, 1000);
            
            // ÏÉùÏÑ± Ìï®Ïàò Ïû¨Ïó∞Í≤∞
            window.startAutoGeneration = finalizedStartAutoGeneration;
            
            // ÏôÑÎ≤ΩÌïú Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
            setupPerfectEventListeners();
            
            // ÏûêÎèô Ï†ÄÏû• ÏãúÏä§ÌÖú
            setupAutoSave();
            
            // Î©îÎ™®Î¶¨ ÏµúÏ†ÅÌôî
            PerformanceOptimizer.startMonitoring();
            
            console.log('‚úÖ ÏôÑÎ≤ΩÌïú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å - Î™®Îì† ÏãúÏä§ÌÖú Ï†ïÏÉÅ ÏûëÎèô');
        }

        function setupPerfectEventListeners() {
            // ÌéòÏù¥ÏßÄ Ïù¥ÌÉà Ïãú Í≤ΩÍ≥†
            window.addEventListener('beforeunload', (e) => {
                if (recordingState.isRecording) {
                    e.preventDefault();
                    e.returnValue = 'ÎÖπÌôîÍ∞Ä ÏßÑÌñâ Ï§ëÏûÖÎãàÎã§. ÌéòÏù¥ÏßÄÎ•º Îñ†ÎÇòÏãúÍ≤†ÏäµÎãàÍπå?';
                }
            });

            // Ïò®ÎùºÏù∏/Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú Í∞êÏßÄ
            window.addEventListener('online', () => {
                showSuccessNotification('üåê Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞Ïù¥ Î≥µÍµ¨ÎêòÏóàÏäµÎãàÎã§!');
            });

            window.addEventListener('offline', () => {
                showStatus('‚ö†Ô∏è Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞Ïù¥ ÎÅäÏñ¥Ï°åÏäµÎãàÎã§. Ïò§ÌîÑÎùºÏù∏ Î™®ÎìúÎ°ú Ï†ÑÌôòÎê©ÎãàÎã§.', 'warning', 'openaiStatus');
            });

            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ Ìñ•ÏÉÅ
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'Enter':
                            e.preventDefault();
                            if (!document.getElementById('generateButton').disabled) {
                                finalizedStartAutoGeneration();
                            }
                            break;
                        case 's':
                            e.preventDefault();
                            if (generatedSlides.length > 0) {
                                downloadContent();
                            }
                            break;
                        case 'r':
                            e.preventDefault();
                            if (generatedSlides.length > 0) {
                                startRecording();
                            }
                            break;
                    }
                }
            });
        }

        function setupAutoSave() {
            setInterval(() => {
                if (generatedSlides.length > 0) {
                    try {
                        const autoSaveData = {
                            slides: generatedSlides,
                            images: generatedImages.filter(img => img.url), // URLÎßå Ï†ÄÏû•
                            timestamp: new Date().toISOString()
                        };
                        localStorage.setItem('autoSave_content', JSON.stringify(autoSaveData));LocalStorage.setitem ( 'Autosave_Content', json.stringify (AutoSaveData));
                    } catch (error) {
                        console.warn('ÏûêÎèô Ï†ÄÏû• Ïã§Ìå®:', error);
                    }
                }
            }, 30000); // 30Ï¥àÎßàÎã§ ÏûêÎèô Ï†ÄÏû•
        }

        // ===== ÏôÑÎ≤ΩÌïú ÏóêÎü¨ ÏóÜÎäî ÏµúÏ¢Ö ÏãúÏä§ÌÖú ÌôúÏÑ±Ìôî =====
        document.addEventListener('DOMContentLoaded', function() {
            perfectInitialization();
        });

        // Ï†ÑÏó≠ ÏóêÎü¨ Ï≤òÎ¶¨ Í∞ïÌôî
        window.addEventListener('error', function(event) {
            console.error('Ï†ÑÏó≠ Ïò§Î•ò Í∞êÏßÄ:', event.error);
            PerformanceOptimizer.cleanupMemory();
            
            // ÏÇ¨Ïö©Ïûê ÏπúÌôîÏ†Å Ïò§Î•ò Î©îÏãúÏßÄ
            if (!event.error.message.includes('Script error')) {
                showStatus('‚ö†Ô∏è ÏùºÏãúÏ†ÅÏù∏ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. ÏûêÎèôÏúºÎ°ú Î≥µÍµ¨Îê©ÎãàÎã§.', 'warning', 'openaiStatus');
            }
            
            // Ïò§Î•ò ÏûêÎèô Î≥µÍµ¨ ÏãúÎèÑ
            setTimeout(() => {
                if (openaiApiKey) {
                    updateGenerateButton();
                }
            }, 2000);
        });

        window.addEventListener('unhandledrejection', function(event) {
            console.error('Ï≤òÎ¶¨ÎêòÏßÄ ÏïäÏùÄ Promise Í±∞Î∂Ä:', event.reason);
            event.preventDefault();
            
            // Promise Ïò§Î•ò ÏûêÎèô Ï≤òÎ¶¨
            if (event.reason && event.reason.message) {
                AdvancedErrorHandler.handleAPIError(event.reason, 'promise-rejection', 0);
            }
        });

        console.log('üèÜ 4Îã®Í≥Ñ ÏôÑÎ£å: ÌôòÏÉÅÏ†ÅÏù∏ ÎßàÎ¨¥Î¶¨ & ÏôÑÎ≤ΩÌïú ÏµúÏ¢Ö ÏãúÏä§ÌÖú Íµ¨Ï∂ï ÏôÑÎ£å! (Ï¥ù 5000+ Ï§Ñ)');
